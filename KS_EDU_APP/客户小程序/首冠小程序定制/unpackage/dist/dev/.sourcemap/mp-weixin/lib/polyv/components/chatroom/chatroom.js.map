{"version":3,"sources":["webpack:///J:/kesionEDU_APP/KS_EDU_APP/客户小程序/首冠小程序定制/lib/polyv/components/chatroom/chatroom.vue?f294","webpack:///J:/kesionEDU_APP/KS_EDU_APP/客户小程序/首冠小程序定制/lib/polyv/components/chatroom/chatroom.vue?adad","webpack:///J:/kesionEDU_APP/KS_EDU_APP/客户小程序/首冠小程序定制/lib/polyv/components/chatroom/chatroom.vue?57f5","webpack:///J:/kesionEDU_APP/KS_EDU_APP/客户小程序/首冠小程序定制/lib/polyv/components/chatroom/chatroom.vue?03e8","webpack:///J:/kesionEDU_APP/KS_EDU_APP/客户小程序/首冠小程序定制/lib/polyv/components/chatroom/chatroom.vue","webpack:///J:/kesionEDU_APP/KS_EDU_APP/客户小程序/首冠小程序定制/lib/polyv/components/chatroom/chatroom.vue?70e3","webpack:///J:/kesionEDU_APP/KS_EDU_APP/客户小程序/首冠小程序定制/lib/polyv/components/chatroom/chatroom.vue?dc88"],"names":["MAX_MSG_COUNT","components","ChatList","ChatEdit","props","showBulletin","type","Boolean","default","skin","String","data","chatList","hasMore","scrollTop","isOnlyHost","comeMore","created","chatEvent","getChatEvent","notJoinLists","clock","chat","chatTop","scrollHeight","chatListHeight","beforeMount","util","getDomRect","then","t","height","mounted","unsub","store","get","bindEvent","getHistoryMessage","initChatListQueue","destroyed","clearInterval","Object","keys","forEach","s","off","methods","handleSeeMore","hasMoreHistory","handleLike","sendLike","handleSendMsg","chatTitle","send","isSelfMsg","handleOnlyHost","handleSeeMoreMsg","chatScrollToBottom","onChatListScroll","handleShowBulletin","$emit","i","on","Event","HISTORY_MESSAGE","e","length","h","$nextTick","SPEAK","id","Error","push","CHAT_IMG","content","values","REMOVE_HISTORY","REMOVE_CONTENT","splice","SYSTEM_MESSAGE","SPEAK_ERROR","SEND_MESSAGE","SPEAK_CENSOR","REWARD","Math","floor","random","LIKES","FLOWERS","CLOSE_ROOM","system","OPEN_ROOM","KICK_USER","user","nick","setInterval","slice"],"mappings":"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","file":"lib/polyv/components/chatroom/chatroom.js","sourcesContent":["import { render, staticRenderFns } from \"./chatroom.vue?vue&type=template&id=0ef3d96a&scoped=true&\"\nimport script from \"./chatroom.vue?vue&type=script&lang=js&\"\nexport * from \"./chatroom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chatroom.vue?vue&type=style&index=0&id=0ef3d96a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0ef3d96a\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"J:\\\\软件\\\\HBuilderX.1.9.4.20190426\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('0ef3d96a', component.options)\n    } else {\n      api.reload('0ef3d96a', component.options)\n    }\n    module.hot.accept(\"./chatroom.vue?vue&type=template&id=0ef3d96a&scoped=true&\", function () {\n      api.rerender('0ef3d96a', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"kesionEDU_APP/KS_EDU_APP/客户小程序/首冠小程序定制/lib/polyv/components/chatroom/chatroom.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chatroom.vue?vue&type=template&id=0ef3d96a&scoped=true&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chatroom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chatroom.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport ChatList from '../chat-list/chat-list'\nimport ChatEdit from '../chat-edit/chat-edit'\nimport Event from \"../../common/chat/eventTypes\";\nimport util from \"../../common/utils/utils\";\nimport store from \"../../store/index\";\nconst MAX_MSG_COUNT = 200;\n\nexport default {\n  components:{\n    ChatList,\n    ChatEdit\n  },\n\tprops:{\n\t\tshowBulletin: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: !1\n\t\t},\n\t\tskin: {\n\t\t\ttype: String,\n\t\t\tdefault: \"black\"\n\t\t}\n\t},\n\tdata(){\n\t\treturn {\n\t\t\tchatList: [],\n\t\t\thasMore: !1,\n\t\t\tscrollTop: 0,\n\t\t\tisOnlyHost: !1,\n\t\t\tcomeMore: !1\n\t\t}\n\t},\n  created() {\n      (this.chatEvent = this.getChatEvent()),\n        (this.notJoinLists = []),\n        (this.clock = null),\n        (this.chat = null),\n        (this.chatTop = 0),\n        (this.scrollHeight = 0),\n        (this.chatListHeight = 0);\n  },\n  beforeMount(){\n\t  util\n        .getDomRect(\".plv-mp-chatroom-scroll-view\", this)\n        .then(({ height: t }) => {\n          this.scrollHeight = t;\n        });\n  },\n  mounted(){\n\t  this.unsub = store.get({\n        \"main.chat\": t => {\n          (this.chat = t),\n            t &&\n              (this.bindEvent(this.chatEvent),\n              this.chat.getHistoryMessage(20, 0),\n              this.initChatListQueue());\n        }\n      });\n  },\n  destroyed(){\n\t  if ((this.unsub(), clearInterval(this.clock), !this.chat)) return;\n      const t = this.chatEvent;\n      Object.keys(t).forEach(s => {\n        this.chat.off(s, t[s]);\n      }),\n        (this.chat = null);\n  },\n  methods: {\n    handleSeeMore() {\n      this.chat.hasMoreHistory() && this.chat.getHistoryMessage();\n    },\n    handleLike() {\n      this.chat.sendLike(1);\n    },\n    handleSendMsg(t) {\n      const s = t.chatTitle;\n      this.chat.send(s), (this.isSelfMsg = !0);\n    },\n    handleOnlyHost(t) {\n\t  const s = t.isOnlyHost;\n\t  this.isOnlyHost = s\n    },\n    handleSeeMoreMsg() {\n\t\tthis.comeMore = !1;\n\t\tthis.chatScrollToBottom();\n    },\n    onChatListScroll(t) {\n      if (((this.chatTop = t.scrollTop), this.comeMore)) {\n        this.chatTop + this.scrollHeight + 10 >= this.chatListHeight &&\n          (this.comeMore = !1);\n      }\n    },\n    handleShowBulletin() {\n      this.$emit(\"onTapBulletin\");\n    },\n    bindEvent(t) {\n      const s = this.chat;\n      s &&\n        Object.keys(t).forEach(i => {\n          s.on(i, t[i]);\n        });\n    },\n    getChatEvent() {\n      const t = this;\n      return {\n        [Event.HISTORY_MESSAGE](s, i) {\n          const e = 0 === t.chatList.length,\n\t\t\th = [...i, ...t.chatList];\n\t\t  t.chatList = h;\n\t\t  t.hasMore = t.chat.hasMoreHistory();\n\t\t  t.$nextTick(()=>{\n\t\t\t  e && t.chatScrollToBottom();\n\t\t  })\n         \n        },\n        [Event.SPEAK](s, i) {\n          let e = !1;\n          try {\n            t.chatList.forEach(t => {\n              if (t.id === i.id) throw ((e = !0), Error(\"same id\"));\n            });\n          } catch (t) {}\n          !e && t.notJoinLists.push(i);\n        },\n        [Event.CHAT_IMG](s, i) {\n          (i.content = i.values[0]), t.notJoinLists.push(i);\n        },\n        [Event.REMOVE_HISTORY]() {\n\t\t\tt.chatList = [];\n\t\t\tt.hasMore = !1;\n        },\n        [Event.REMOVE_CONTENT](s, i) {\n          const e = [...t.chatList];\n          e.forEach((s, h) => {\n            s.id === i.id && (e.splice(h, 1), ( t.chatList = e));\n          });\n        },\n        [Event.SYSTEM_MESSAGE](s, i) {\n          t.notJoinLists.push(i);\n        },\n        [Event.SPEAK_ERROR](s, i) {\n          t.notJoinLists.push(i);\n        },\n        [Event.SEND_MESSAGE](s, i) {\n\t\t\tt.chatList = [...t.chatList, i]\n\t\t\tt.$nextTick(()=>{\n\t\t\t\tt.chatScrollToBottom();\n\t\t\t})\n          \n        },\n        [Event.SPEAK_CENSOR](s, i) {\n\t\t  const e = `chatList[${t.chatList.length - 1}].id`;\n\t\t  t[e] = i.id;\n        },\n        [Event.REWARD](s, i) {\n          t.notJoinLists.push({ ...i, id: Math.floor(1e7 * Math.random()) });\n        },\n        [Event.LIKES](s, i) {\n          t.notJoinLists.push({ ...i, id: Math.floor(1e7 * Math.random()) });\n        },\n        [Event.FLOWERS](s, i) {\n          t.notJoinLists.push({ ...i, id: Math.floor(1e7 * Math.random()) });\n        },\n        [Event.CLOSE_ROOM]() {\n          t.notJoinLists.push({\n            id: Math.floor(1e7 * Math.random()),\n            system: !0,\n            content: \"房间暂时关闭\"\n          });\n        },\n        [Event.OPEN_ROOM]() {\n          t.notJoinLists.push({\n            id: Math.floor(1e7 * Math.random()),\n            system: !0,\n            content: \"房间已经打开\"\n          });\n        },\n        [Event.KICK_USER](s, i) {\n          t.notJoinLists.push({\n            system: !0,\n            content: `${i.user.nick}[被踢出房间]`\n          })\n        }\n      }\n    },\n    initChatListQueue() {\n      this.clock = setInterval(() => {\n        if (this.notJoinLists.length) {\n          const t = this.chatListHeight - 2 * this.scrollHeight <= this.chatTop;\n          let s = [...this.chatList, ...this.notJoinLists];\n          s.length > 200 && (s = s.slice(200)),\n\t\t\t(this.chatList = s),\n            (this.notJoinLists = []),\n            this.$nextTick(() => {\n              t\n                ? this.chatScrollToBottom()\n                : (util.getDomRect(\"#chatList\", this).then(({ height: t }) => {\n                    this.chatListHeight = t;\n\t\t\t\t  }),\n\t\t\t\t  (this.comeMore = !this.isSelfMsg),\n\t\t\t\t  (this.isSelfMsg = !1));\n            });\n        }\n      }, 600);\n    },\n    chatScrollToBottom() {\n      util.getDomRect(\"#chatList\", this).then(({ height: t }) => {\n        (this.chatListHeight = t), (this.scrollTop = t);\n      });\n    }\n  }\n};\n","import mod from \"-!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chatroom.vue?vue&type=style&index=0&id=0ef3d96a&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../软件/HBuilderX.1.9.4.20190426/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chatroom.vue?vue&type=style&index=0&id=0ef3d96a&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}