webpackJsonp([33],{imwT:function(t,e){},rKSW:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("4YfN"),a=n.n(s),i=n("BXtI"),o={name:"signInManage",data:function(){return{loading:!1,region:"昵称",regionList:["昵称","手机号"],key:"",success_num:"",sign_num:"",nosign_num:"",showPopover:!1,stateActive:-1,signStateActive:-1,tableDataList:[],dialogTableVisible:!1,page:null,currentPage:1,qrcode:""}},computed:{formatTimestamp:function(){return function(t){var e=new Date(parseInt(t)),n=e.getFullYear(),s=e.getMonth()+1,a=e.getDate(),i=e.getHours(),o=e.getMinutes(),c=e.getSeconds();return n+"-"+(s=s<10?"0"+s:s)+"-"+(a=a<10?"0"+a:a)+" "+(i=i<10?"0"+i:i)+":"+(o=o<10?"0"+o:o)+":"+(c=c<10?"0"+c:c)}}},activated:function(){this.getSignList()},methods:{search:function(){var t={keywordtype:this.regionList.indexOf(this.region)+1,keyword:this.key};this.getSignList(t)},changeStateActive:function(t){this.stateActive=t,-1==t&&(t="")},changeSignStateActive:function(t){this.signStateActive=t,-1==t&&(t=""),this.getSignList({is_sign:t,status:-1!=this.stateActive||""}),this.showPopover=!1},setSignIn:function(t){var e=this;Object(i.b)({id:t.id}).then(function(t){(t.result="success")&&e.getSignList({p:e.currentPage})})},passCheck:function(t){var e=this;Object(i.a)({id:t,status:1}).then(function(t){(t.result="success")&&e.getSignList({p:e.currentPage})})},rejectCheck:function(t){var e=this;Object(i.a)({id:t,status:2}).then(function(t){(t.result="success")&&e.getSignList({p:e.currentPage})})},handleCurrentChange:function(t){this.getSignList({p:t})},getSignList:function(t){var e=this,n={p:1,maxperpage:10,courseid:this.$route.query.id,is_home:1};Object(i.i)(a()({},n,t)).then(function(t){e.success_num=t.success_num,e.sign_num=t.sign_num,e.nosign_num=t.nosign_num,e.tableDataList=t.list,e.page=t.page,e.qrcode=t.qrcode,e.loading=!0})}}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loading?n("ks-container",[n("el-breadcrumb",{attrs:{separator:"/"}},[n("el-breadcrumb-item",[t._v("活动报名")]),t._v(" "),n("el-breadcrumb-item",[t._v("签到管理")])],1),t._v(" "),n("el-row",{staticClass:"search-row"},[n("el-col",{attrs:{span:15}},[n("el-select",{staticClass:"search-select",attrs:{size:"small"},model:{value:t.region,callback:function(e){t.region=e},expression:"region"}},t._l(t.regionList,function(t,e){return n("el-option",{key:e,attrs:{value:t}})}),1),t._v(" "),n("el-input",{staticClass:"search-input",attrs:{size:"small"},on:{change:t.search},model:{value:t.key,callback:function(e){t.key=e},expression:"key"}},[n("i",{staticClass:"el-input__icon iconfont icon-sousuo",attrs:{slot:"suffix"},on:{click:t.search},slot:"suffix"})])],1),t._v(" "),n("el-col",{staticClass:"plus-col",attrs:{span:9}},[n("div",{staticClass:"sign-state"},[t._v("报名成功 : "+t._s(t.success_num)+"   已签到 : "+t._s(t.sign_num)+"   未签到 : "+t._s(t.nosign_num))]),t._v(" "),n("el-popover",{attrs:{placement:"bottom-end",width:"330",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[n("div",{staticClass:"state"},[n("div",{staticClass:"state__title"},[t._v("状态 :")]),t._v(" "),n("div",{staticClass:"state__content"},[n("span",{class:-1==t.stateActive?"state__actived":"",on:{click:function(e){return t.changeStateActive(-1)}}},[t._v("不限")]),t._v(" "),n("span",{class:0==t.stateActive?"state__actived":"",on:{click:function(e){return t.changeStateActive(0)}}},[t._v("未审核")]),t._v(" "),n("span",{class:1==t.stateActive?"state__actived":"",on:{click:function(e){return t.changeStateActive(1)}}},[t._v("已审核")]),t._v(" "),n("span",{class:2==t.stateActive?"state__actived":"",on:{click:function(e){return t.changeStateActive(2)}}},[t._v("被拒绝")]),t._v(" "),n("span",{class:3==t.stateActive?"state__actived":"",on:{click:function(e){return t.changeStateActive(3)}}},[t._v("已出票")])])]),t._v(" "),n("div",{staticClass:"state"},[n("div",{staticClass:"state__title"},[t._v("签到 :")]),t._v(" "),n("div",{staticClass:"state__content"},[n("span",{class:-1==t.signStateActive?"state__actived":"",on:{click:function(e){return t.changeSignStateActive(-1)}}},[t._v("不限")]),t._v(" "),n("span",{class:0==t.signStateActive?"state__actived":"",on:{click:function(e){return t.changeSignStateActive(0)}}},[t._v("未签到")]),t._v(" "),n("span",{class:1==t.signStateActive?"state__actived":"",on:{click:function(e){return t.changeSignStateActive(1)}}},[t._v("已签到")])])]),t._v(" "),n("el-button",{staticClass:"filter",attrs:{slot:"reference",type:"primary",icon:"iconfont icon-filter",size:"small"},slot:"reference"})],1),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.dialogTableVisible=!0}}},[t._v("二维码签到")])],1)],1),t._v(" "),n("div",[n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableDataList}},[n("el-table-column",{attrs:{label:"头像昵称","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:e.row.head}}),t._v(" "),n("span",[t._v(t._s(e.row.name))])])]}}],null,!1,2546334186)}),t._v(" "),n("el-table-column",{attrs:{prop:"json.form[0].content",label:"姓名",align:"center","min-width":"60"}}),t._v(" "),n("el-table-column",{attrs:{prop:"json.form[1].content",label:"手机号",align:"center","min-width":"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"ticket_info.title",label:"票种",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"deposit",label:"价格",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",[t._v(t._s(0==e.row.ticket_info.chargetype?"0.00":e.row.ticket_info.price))]),t._v(" "),n("span",{staticStyle:{color:"#E64A3B"}},[t._v("( 定金 : ￥ "+t._s(e.row.json.cash_deposit||"0.00")+" )")])])]}}],null,!1,508574073)}),t._v(" "),n("el-table-column",{attrs:{prop:"json.number",label:"票号",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-dropdown",{attrs:{placement:"bottom"}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n              "+t._s(e.row.json.num)+" 张票\n              "),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(e.row.json.number,function(e,s){return n("el-dropdown-item",{key:s},[t._v(t._s(e))])}),1)],1)]}}],null,!1,2203464948)}),t._v(" "),n("el-table-column",{attrs:{label:"报名时间","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.adddate?n("div",[t._v("\n          "+t._s(t.formatTimestamp(1e3*e.row.adddate))+"\n          ")]):n("div",[t._v("---")])]}}],null,!1,1470618363)}),t._v(" "),n("el-table-column",{attrs:{label:"签到时间","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0!=e.row.sign_date?n("div",[t._v(t._s(t.formatTimestamp(1e3*e.row.sign_date)))]):n("div",[t._v("---")])]}}],null,!1,1910962711)}),t._v(" "),n("el-table-column",{attrs:{label:"签到状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[1==e.row.is_sign?n("span",[t._v("已签到")]):n("span",{staticStyle:{color:"#E64A3B"}},[t._v("未签到")])])]}}],null,!1,884508549)}),t._v(" "),n("el-table-column",{attrs:{label:"审核状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[0==e.row.status?n("span",{staticStyle:{color:"#E64A3B"}},[t._v("未审核")]):1==e.row.status&&1==e.row.ticket_info.check?n("span",[t._v("已审核")]):1==e.row.status&&0==e.row.ticket_info.check?n("span",[t._v("不需要审核")]):2==e.row.status?n("span",{staticStyle:{color:"#E64A3B"}},[t._v("被拒绝")]):3==e.row.status&&1==e.row.ticket_info.check?n("span",[t._v("已审核")]):3==e.row.status&&0==e.row.ticket_info.check?n("span",[t._v("不需要审核")]):t._e()])]}}],null,!1,946494522)}),t._v(" "),n("el-table-column",{attrs:{label:"报名状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[1==e.row.ticket_info.chargetype?n("div",[1==e.row.paystatus?n("span",[t._v("报名成功")]):n("span",[t._v("未支付")])]):n("div",[3==e.row.status?n("span",[t._v("报名成功")]):0==e.row.status?n("span",[t._v("---")]):t._e(),t._v(" "),2==e.row.status?n("span",{staticStyle:{color:"#E64A3B"}},[t._v("报名失败")]):t._e()])])]}}],null,!1,4287525837)}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-dropdown",{attrs:{trigger:"click",placement:"bottom"}},[n("span",{staticClass:"table-operation"},[t._v("...")]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[1==e.row.is_sign?n("span",{on:{click:function(n){return t.setSignIn(e.row)}}},[n("el-dropdown-item",[t._v("取消签到")])],1):n("span",{on:{click:function(n){return t.setSignIn(e.row)}}},[n("el-dropdown-item",[t._v("恢复签到")])],1),t._v(" "),0==e.row.status?[n("span",{on:{click:function(n){return t.passCheck(e.row.id)}}},[n("el-dropdown-item",[t._v("通过审核")])],1),t._v(" "),n("span",{on:{click:function(n){return t.rejectCheck(e.row.id)}}},[n("el-dropdown-item",[t._v("拒绝审核")])],1)]:t._e()],2)],1)]}}],null,!1,4098491555)})],1)],1),t._v(" "),n("div",{staticClass:"footer"},[n("el-pagination",{attrs:{layout:"prev, pager, next",background:"",total:+t.page.totalput,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleCurrentChange}})],1),t._v(" "),n("el-dialog",{attrs:{title:"二维码签到",visible:t.dialogTableVisible,width:"40%",center:""},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[n("div",{staticClass:"qr-code"},[n("img",{attrs:{src:t.qrcode}}),t._v(" "),n("div",{staticClass:"save"},[n("p",[t._v("用于线下扫码签到 , 右键保存图片")]),t._v(" "),n("p",[n("a",{attrs:{href:t.qrcode,download:"qrcode"}},[t._v("点击下载可打印大图")])])])]),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogTableVisible=!1}}},[t._v("取 消")])],1)])],1):t._e()},staticRenderFns:[]};var r=n("C7Lr")(o,c,!1,function(t){n("imwT")},"data-v-80660d86",null);e.default=r.exports}});