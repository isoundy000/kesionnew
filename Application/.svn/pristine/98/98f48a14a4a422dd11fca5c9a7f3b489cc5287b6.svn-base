webpackJsonp([4,56],{"++tE":function(t,e,i){"use strict";var a={data:function(){for(var t=[],e=65;e<91;e++)t.push(String.fromCharCode(e));return{letters:t,tkTypes:[{id:"1",name:"简答题"},{id:"2",name:"单选题"},{id:"3",name:"多选题"},{id:"4",name:"判断题"},{id:"5",name:"填空题"},{id:"6",name:"组合题"}]}},filters:{filterAnswer:function(t,e){if(3==e)return t.join();if(4==e)return(""+t=="0"?"错误":""+t=="1"&&"正确")||"暂无答案";if(5==e){var i="";return t.map(function(t,e){i+=e>0?" 、 ("+t.join(" || ")+")":"("+t.join(" || ")+")"}),i}return t||"暂无答案"},filterHtml:function(t){return t.replace(/\<[^>]+>/gi,"")}},methods:{getTkTypeName:function(t){if(t){t=parseInt(t);var e=void 0;return this.tkTypes.map(function(i){i.id==t&&(e=i.name)}),e}}}};e.a=a},"/PUX":function(t,e){},"7tv2":function(t,e){},GMUD:function(t,e){},TPLH:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("++tE"),s=i("0xDb"),n=i("g+M4"),l=i("olFL"),o=(i("Llv5"),{name:"PaperAdd",props:["tkid"],data:function(){return{loaded:!0,searchContent:"",select:"",selectedList:[],p:1,pageCount:null,tableData:[],totalPut:0,currpage:0,options:[{value:"1",label:"单选题"},{value:"2",label:"填空题"},{value:"3",label:"判断题"},{value:"4",label:"简答题"},{value:"5",label:"组合题"},{value:"6",label:"多选题"}],options1:[{value:"0",label:"不限"},{value:"1",label:"低"},{value:"2",label:"中"},{value:"3",label:"高"}],tktype:"1",tkhard:"0",categoryid:"",pretype:""}},methods:{save:function(){var t=[];this.tableData.map(function(e){e.checked&&!1===e.disabled&&t.push(e)}),this.$emit("callback",t),this.$emit("update:dialogVisible",!1)},getList:function(t){var e=this;Object(n.m)({p:this.p,tktype:t,level:this.tkhard,categoryid:this.categoryid}).then(function(t){t.list.map(function(t){t.checked=!1,t.disabled=!1}),e.tableData=t.list,e.p=t.page.now_page,e.pageCount=t.page.total_pages,e.totalPut=parseInt(t.page.totalput),e.tableData.map(function(t){e.selectedList.map(function(e){e.tkid==t.tkid&&(t.checked=!0,t.disabled=!0)})})})},handleSelectionChange:function(t){this.multipleSelection=t},handleCurrentChange:function(t){this.tableData=[],this.p=t,this.getList()},golist:function(){this.getList()},consoleBak:function(){},reset:function(t){this.p=1,this.categoryid=t.categoryid,this.selectedList=t.selectedList,this.getList(t.tktype),this.pretype=t.pretype}}}),r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-main",[i("el-row",{staticClass:"ks-bo20"},[i("el-col",{attrs:{span:16}},[i("el-select",{staticClass:"ks-w150",attrs:{placeholder:"请选择难度"},on:{change:t.golist},model:{value:t.tkhard,callback:function(e){t.tkhard=e},expression:"tkhard"}},t._l(t.options1,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:t.searchContent,callback:function(e){t.searchContent=e},expression:"searchContent"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{label:"选择",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-checkbox",{attrs:{disabled:e.row.disabled},model:{value:e.row.checked,callback:function(i){t.$set(e.row,"checked",i)},expression:"scope.row.checked"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{type:"index",width:"55",label:"序号"}}),t._v(" "),i("el-table-column",{attrs:{prop:"level",label:"难度系数",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"typeName",label:"题目类型",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"title",label:"题目"}}),t._v(" "),i("el-table-column",{attrs:{prop:"inputer",label:"题目来源"}}),t._v(" "),i("el-table-column",{attrs:{prop:"adddate",label:"添加时间"}})],1)],1)],1)],1),t._v(" "),i("el-footer",[i("div",{staticStyle:{"text-align":"center"}},[i("el-button",{staticClass:"fl",attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),t._v(" "),i("div",{staticClass:"fr"},[i("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.totalPut},on:{"current-change":t.handleCurrentChange}})],1)],1)])],1)},staticRenderFns:[]};var c=i("C7Lr")(o,r,!1,function(t){i("7tv2")},"data-v-3908cce4",null).exports,u={name:"PaperAdd",props:{paperId:String},data:function(){return{loaded:!0,form:{EaxmTime:"",PaperLevel:"",chargetype:0,price:"",price_market:"",paperId:this.paperId,is_vip:0,time:0,intro:""}}},methods:{onSubmit:function(){var t=this;Object(n.o)({exam_time:this.form.EaxmTime,paper_level:this.form.PaperLevel,chargetype:this.form.chargetype,price:this.form.price,price_market:this.form.price_market,paperid:this.paperId,time:this.form.time,shortdesc:this.form.intro,is_vip:this.is_vip}).then(function(e){"success"===e.result&&(t.$msg("设置成功","success"),t.$emit("callback"))})},handleSelectionChange:function(t){this.multipleSelection=t},getDetail:function(){var t=this;Object(n.h)({paperid:this.paperId}).then(function(e){var i=e.list;t.form.EaxmTime=i.exam_time,t.form.PaperLevel=i.paper_level,t.form.chargetype=Number(i.chargetype),t.form.time=Number(i.time),t.form.price_market=i.price_market,t.form.price=i.price,t.form.intro=i.shortdesc})}},created:function(){this.getDetail()},watch:{paperId:function(){this.getDetail()}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-main",[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"160px"}},[i("el-form-item",{attrs:{label:"考试时间"}},[i("el-input",{staticStyle:{width:"150px"},model:{value:t.form.EaxmTime,callback:function(e){t.$set(t.form,"EaxmTime",e)},expression:"form.EaxmTime"}}),t._v("  分钟\n      ")],1),t._v(" "),i("el-form-item",{attrs:{label:"考试难度"}},[i("el-select",{attrs:{placeholder:"考试难度"},model:{value:t.form.PaperLevel,callback:function(e){t.$set(t.form,"PaperLevel",e)},expression:"form.PaperLevel"}},[i("el-option",{attrs:{label:"低",value:"1"}}),t._v(" "),i("el-option",{attrs:{label:"中",value:"2"}}),t._v(" "),i("el-option",{attrs:{label:"高",value:"3"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"考试次数"}},[i("el-radio-group",{model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}},[i("el-radio",{attrs:{label:1},model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}},[t._v("一次")]),t._v(" "),i("el-radio",{attrs:{label:0},model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}},[t._v("无限")])],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"试卷介绍"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.form.intro,callback:function(e){t.$set(t.form,"intro",e)},expression:"form.intro"}})],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)],1)},staticRenderFns:[]};var p=i("C7Lr")(u,d,!1,function(t){i("tdgT")},"data-v-831027bc",null).exports,m={name:"RandomQuestion",props:{selectedTkids:{type:Array,default:function(){return[]}},categoryid:[Number,String],tips:String},data:function(){return{tkList:[]}},methods:{save:function(){var t=this,e=[],i=[];this.tkList.map(function(t){t.value&&t.tk_num&&(i.push(t.tk_type),e.push(t.value))}),e.length?Object(n.l)({categoryid:this.categoryid,tmnum:e,tkids:this.selectedTkids,tmtype:i}).then(function(e){"success"==e.result&&(t.$msg("试题设置成功","success"),t.tkList.map(function(t){e.list.map(function(e){e.tktype==t.tk_type&&(e.score=t.tkscore)})}),t.$emit("callback",e.list))}):this.$msg("请先设置抽取题数")},handleInputValueChange:function(t){t.total=t.value*t.tkscore||0},getList:function(){var t=this;Object(n.k)({categoryid:this.categoryid,tkids:this.selectedTkids}).then(function(e){e.list.map(function(t){t.tk_num=Number(t.tk_num),t.tkscore=0,t.value=0,t.total=0}),t.tkList=e.list})}},watch:{categoryid:function(){this.getList()},selectedTkids:{handler:function(){this.getList()},deep:!0}},mounted:function(){this.getList()}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.tips?i("el-alert",{attrs:{title:t.tips,type:"warning",closable:!1}}):t._e(),t._v(" "),i("div",{staticClass:"random-question"},t._l(t.tkList,function(e,a){return i("el-row",{key:a,staticClass:"random-row",class:e.tk_num<=0&&"ks-color-info",attrs:{gutter:20}},[i("el-col",{attrs:{span:-1}},[i("div",{staticClass:"exam-icon",staticStyle:{"text-align":"center"}},[t._v(t._s(e.type_name))])]),t._v(" "),i("el-col",{attrs:{span:4}},[i("div",{staticClass:"exam-icon"},[i("ks-input-number",{attrs:{max:e.tk_num,disabled:e.tk_num<=0,unit:"题"},on:{change:function(i){return t.handleInputValueChange(e)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}})],1)]),t._v(" "),i("el-col",{staticClass:"ks-ml10",attrs:{span:-1}},[t._v("(可选 "+t._s(e.tk_num)+"道题)")]),t._v(" "),i("el-col",{staticClass:"ks-ml20",attrs:{span:-1}},[t._v("每题")]),t._v(" "),i("el-col",{attrs:{span:4}},[i("ks-input-number",{attrs:{"decimal-places":1,disabled:e.tk_num<=0,unit:"分"},on:{change:function(i){return t.handleInputValueChange(e)}},model:{value:e.tkscore,callback:function(i){t.$set(e,"tkscore",i)},expression:"item.tkscore"}})],1),t._v(" "),i("el-col",{staticClass:"ks-ml10",attrs:{span:-1}},[t._v("共 "+t._s(e.total)+"分")])],1)}),1),t._v(" "),i("div",{attrs:{align:"center"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确定")])],1)],1)},staticRenderFns:[]};var h=i("C7Lr")(m,f,!1,function(t){i("lsLI")},"data-v-7ff1e49c",null).exports,v=i("xeox"),_={name:"PaperAddList",components:{PaperChoice:c,PaperAdd:l.default,PaperSet:p,RandomQuestion:h,QuestionList:v.a},mixins:[a.a],data:function(){return{loaded:!1,totalScore:0,totalQuestionNumber:0,is_open:"1",editPaperVisible:!1,selectQuestionVisible:!1,randomQuestionVisible:!1,advancedSettingsVisible:!1,selectedTkids:[],questionTypes:[],paperId:this.$route.query.paperId,detail:{},typeValue:"1",currentSelected:0,questions:[],defaultScore:10}},methods:{paperSavedCall:function(t){this.editPaperVisible=!1,this.detail.title=t.title,this.detail.categoryid=t.categoryid,this.detail.scoreout=t.scoreout},randomSelectedCall:function(t){this.questionSelectedCall(t),this.randomQuestionVisible=!1},questionSelectedCall:function(t){var e=this;Object(s.b)(t).map(function(t,i){t.showFlag=!1,6==t.tktype?t.tkinfo.childtk.map(function(t){t.showFlag=!1,t.score||(t.score=e.defaultScore)}):t.score||(t.score=e.defaultScore),e.questions[e.currentSelected].tklist.push(t)}),this.selectQuestionVisible=!1,this.calculateTotalQuestionNumber(),this.calculateBigQuestionScore(this.currentSelected)},calculateTotalQuestionNumber:function(){var t=0;1==this.detail.exam_type?this.questions.map(function(e){t+=e.tk_num}):2==this.detail.exam_type&&this.questions.map(function(e){t+=e.tklist.length}),this.totalQuestionNumber=t},calculateTotalScore:function(){var t=0;this.questions.map(function(e){t+=Number(e.dtscore)}),this.totalScore=t},calculateBigQuestionScore:function(t){var e=0,i=this.questions[t];1==this.detail.exam_type?e=i.score*i.tk_num||0:i.tklist.map(function(t){if(6==t.tktype){var i=0;t.tkinfo.childtk.map(function(t){t.score&&(i+=Number(t.score))}),t.score=i}t.score&&(e+=Number(t.score))}),i.dtscore=e,this.calculateTotalScore()},getTkTotalNum:function(t){var e=0;return this.questionTypes.map(function(i){i.tk_type==t&&(e=i.tk_num)}),e},getRadomItemData:function(t){this.questionTypes.map(function(e){e.tk_type==t.tktype&&(t.total=e.tk_num,t.tk_num>e.tk_num&&(t.tk_num=e.tk_num))})},submit:function(){for(var t=this,e=[],i=0;i<this.questions.length;i++){var a=this.questions[i];if(!a.title)return this.$msg("请先输入第"+(i+1)+"大题名称"),this.$refs["bigTitle"+i][0].focus(),!1;2==this.detail.exam_type?function(){var t=[];a.tklist.map(function(e){var i=e.score;if(6==e.tktype){var a=[];e.tkinfo.childtk.map(function(t){a.push(t.score)}),i=a}t.push({tkid:e.tkid,score:i,tktype:e.tktype})}),e.push({title:a.title,intro:a.intro||"",dtscore:a.dtscore,tklist:t})}():e.push({title:a.title,intro:a.intro||"",dtscore:a.dtscore,score:a.score,tktype:a.tktype,tk_num:a.tk_num})}Object(n.b)({title:this.detail.title,paperid:this.paperId,sumscore:this.totalScore,tk_num:this.totalQuestionNumber,is_open:this.is_open,tmlist:e}).then(function(e){"success"==e.result&&(t.$msg("保存成功","success"),t.$router.push("/?url=/home.html/exam/Index?appid-10"))})},getDetail:function(){var t=this;this.loaded=!1,Object(n.h)({paperid:this.paperId}).then(function(e){if("success"===e.result){var i=e.list;t.is_open=i.is_open,1==i.exam_type?Object(n.k)({categoryid:i.categoryid}).then(function(e){e.list.map(function(t){t.tk_type=t.tk_type.toString(),t.tk_num=Number(t.tk_num)}),t.questionTypes=e.list,i.tmlist.map(function(e){var i=t.getTkTotalNum(e.tktype);e.total=i,e.tk_num>i&&(e.tk_num=i)}),t.questions=i.tmlist}):(i.tmlist.map(function(t){t.tklist.map(function(t){6==t.tktype&&t.tkinfo.childtk.map(function(t){t.showFlag=!1}),t.showFlag=!1})}),t.questions=i.tmlist),t.totalQuestionNumber=i.tk_num,t.totalScore=i.sumscore,t.detail=i}t.loaded=!0})},dropMeun:function(t){t.showFlag?t.showFlag=!1:t.showFlag=!0},del:function(t,e){this.questions[t].tklist.splice(e,1),this.calculateBigQuestionScore(t),this.calculateTotalQuestionNumber()},set:function(){this.advancedSettingsVisible=!0},back:function(){history.back()},multiple:function(t){this.updateTkids(),this.typeValue=t.tktype,this.currentSelected=t.dtindex,this.selectQuestionVisible=!0},updateTkids:function(){var t=[];this.questions.map(function(e){e.tklist.map(function(e){t.push(e.tkid)})}),this.selectedTkids=t},random:function(t){this.updateTkids(),this.currentSelected=t,this.randomQuestionVisible=!0},addTkType:function(){1==this.detail.exam_type?this.questions.push({title:"",dtscore:0,intro:"",tk_num:0,total:0,tklist:[]}):2==this.detail.exam_type&&this.questions.push({title:"",dtscore:0,intro:"",tklist:[]})},delBigQuestion:function(t){this.questions.splice(t,1)},upFieldOrder:function(t,e){var i=e[t-1];this.$set(e,t-1,e[t]),this.$set(e,t,i)},downFieldOrder:function(t,e){var i=e[t+1];this.$set(e,t+1,e[t]),this.$set(e,t,i)},fraction:function(t){t<0?(this.$message({message:"数字不能小于0",type:"warning"}),t=""):t=t.toFixed(1)}},activated:function(){this.paperId=this.$route.query.paperId,this.detail={},this.questions=[],this.getDetail()}},k={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.loaded?i("ks-container",[i("el-breadcrumb",{staticClass:"ks-breadcrumb",attrs:{separator:"/"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/?url=/home.html/exam/Index?appid-10"}}},[t._v("试卷管理")]),t._v(" "),i("el-breadcrumb-item",[t._v("添加试卷")])],1),t._v(" "),i("div",{staticClass:"paper-title"},[i("div",{staticClass:"ks-fr"},[i("el-button",{attrs:{type:"primary"},on:{click:t.set}},[t._v("高级设置")]),t._v(" "),i("el-button",{on:{click:function(e){return t.$router.back()}}},[t._v("返回")])],1),t._v("基础配置\n  ")]),t._v(" "),i("el-row",{staticClass:"paper-info ks-mt10"},[i("el-col",{attrs:{span:24}},[i("el-col",{attrs:{span:16}},[i("div",{staticClass:"paper-info__head"},[i("span",{staticClass:"paper-info__title"},[t._v(t._s(t.detail.title))]),t._v(" "),i("span",{staticClass:"ks-color-primary"},[t._v("共"+t._s(t.totalQuestionNumber)+"题")]),t._v(" "),i("span",{staticClass:"ks-color-primary"},[t._v(t._s(2==t.detail.exam_type?"手动组卷":1==t.detail.exam_type&&"随机组卷"))])]),t._v(" "),i("div",{staticClass:"ks-color-info ks-fz12 ks-mt20"},[t._v("创建时间："+t._s(t.detail.adddate))])]),t._v(" "),i("el-col",{attrs:{align:"right",span:8}},[i("div",{staticClass:"paper-info__count ks-color-warning"},[t._v(t._s(t.totalScore)+"分")]),t._v(" "),i("el-button",{staticClass:"ks-mt15",attrs:{type:"primary",plain:""},on:{click:function(e){t.editPaperVisible=!0}}},[t._v("编辑")])],1)],1)],1),t._v(" "),i("div",{staticClass:"paper-title"},[t._v("题目列表")]),t._v(" "),2==t.detail.exam_type?i("el-row",[t.questions.length?i("div",t._l(t.questions,function(e,a){return i("div",{key:a,staticClass:"ks-mt20"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:16}},[i("div",{staticClass:"paepr-text"},[t._v("第"+t._s(a+1)+"大题")]),t._v(" "),i("el-input",{ref:"bigTitle"+a,refInFor:!0,staticClass:"paepr-input ks-ml10",attrs:{placeholder:"请输入大题名称"},model:{value:e.title,callback:function(i){t.$set(e,"title",i)},expression:"dryItem.title"}}),t._v(" "),i("el-input",{staticClass:"paepr-input ks-ml10",attrs:{placeholder:"请输入大题说明"},model:{value:e.intro,callback:function(i){t.$set(e,"intro",i)},expression:"dryItem.intro"}})],1),t._v(" "),i("el-col",{attrs:{span:8,align:"right"}},[i("el-dropdown",{on:{command:t.multiple}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[t._v("添加小题")]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.tkTypes,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:{dtindex:a,tktype:e.id}}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),i("el-button",{staticClass:"ks-ml10",attrs:{type:"primary"},on:{click:function(e){return t.random(a)}}},[t._v("随机抽题")]),t._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.delBigQuestion(a)}}},[t._v("删除")])],1)],1),t._v(" "),i("el-row",{staticClass:"paper-questions"},[e.tklist.length?i("div",t._l(e.tklist,function(s,n){return i("el-row",{key:n,staticClass:"paper-question-item",class:s.showFlag&&"active"},[i("el-col",{attrs:{span:24}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"paper-question-item__tit"},[i("span",[t._v(t._s(n+1)+"、")]),t._v(" "),i("span",[t._v("难度："+t._s(s.level))]),t._v(" "),i("span",{staticClass:"ks-ml20"},[t._v("题型："+t._s(s.type_name))])])]),t._v(" "),i("el-col",{attrs:{span:18,align:"right"}},[i("div",{staticClass:"paper-question-item__opeart"},[i("ks-input-number",{attrs:{disabled:6==s.tktype,placeholder:"填写分数","decimal-places":1,unit:"分"},on:{change:function(e){return t.calculateBigQuestionScore(a)}},model:{value:s.score,callback:function(e){t.$set(s,"score",e)},expression:"item.score"}})],1),t._v(" "),i("div",{staticClass:"paper-question-item__opeart"},[i("el-button",{attrs:{type:"primary",plain:"",size:"small",disabled:0===n,icon:"el-icon-arrow-up",circle:""},on:{click:function(i){return t.upFieldOrder(n,e.tklist)}}}),t._v(" "),i("el-button",{attrs:{type:"primary",plain:"",size:"small",disabled:n===e.tklist.length-1,icon:"el-icon-arrow-down",circle:""},on:{click:function(i){return t.downFieldOrder(n,e.tklist)}}})],1),t._v(" "),i("div",{staticClass:"paper-question-item__opeart"},[i("el-button-group",[i("el-button",{on:{click:function(e){return t.dropMeun(s)}}},[t._v(t._s(s.showFlag?"收起":"展开"))]),t._v(" "),i("el-button",{staticClass:"paper-question-item__del",attrs:{icon:"el-icon-delete"},on:{click:function(e){return t.del(a,n)}}})],1)],1)])],1),t._v(" "),i("el-col",{staticClass:"paper-question-item__intro",attrs:{span:24}},[i("div",{domProps:{innerHTML:t._s(s.title)}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:s.showFlag,expression:"item.showFlag"}],staticClass:"paper-question-item__info"},[6==s.tktype?i("div",t._l(s.tkinfo.childtk,function(e,s){return i("div",{key:s,staticClass:"paper-question-item paper-question-item--s"},[i("el-row",[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"paper-question-item__tit"},[i("span",[t._v(t._s(n+1)+"-"+t._s(s+1))]),t._v(" "),i("span",[t._v("题型："+t._s(e.type_name))])])]),t._v(" "),i("el-col",{attrs:{span:18,align:"right"}},[i("div",{staticClass:"paper-question-item__opeart"},[i("ks-input-number",{attrs:{placeholder:"填写分数","decimal-places":1,unit:"分"},on:{change:function(e){return t.calculateBigQuestionScore(a)}},model:{value:e.score,callback:function(i){t.$set(e,"score",i)},expression:"mark.score"}})],1),t._v(" "),i("el-button",{on:{click:function(i){return t.dropMeun(e)}}},[t._v(t._s(e.showFlag?"收起":"展开"))])],1),t._v(" "),i("el-col",{staticClass:"paper-question-item__intro",attrs:{span:24}},[i("div",{domProps:{innerHTML:t._s(e.title)}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showFlag,expression:"mark.showFlag"}],staticClass:"paper-question-item__info"},[1!=e.tktype?i("p",[t._v("答案："+t._s(t._f("filterAnswer")(e.tkinfo.answer,e.tktype)))]):t._e(),t._v(" "),i("p",[t._v("解析："+t._s(t._f("filterHtml")(e.tkinfo.analysis)))])])])],1)],1)}),0):i("div",[1!=s.tktype?i("p",[t._v("答案："+t._s(t._f("filterAnswer")(s.tkinfo.answer,s.tktype)))]):t._e(),t._v(" "),i("p",[t._v("解析："+t._s(t._f("filterHtml")(s.tkinfo.analysis)))])])])])],1)}),1):t._e()])],1)}),0):i("div",{staticClass:"ks-empty"},[t._v("暂无题型")])]):t._e(),t._v(" "),1==t.detail.exam_type?i("el-row",[t.questions.length?i("div",t._l(t.questions,function(e,a){return i("el-row",{key:a,staticClass:"radom-item",attrs:{gutter:20}},[i("el-col",{attrs:{span:-1}},[t._v("第"+t._s(a+1)+"大题")]),t._v(" "),i("el-col",{attrs:{span:3}},[i("el-input",{ref:"bigTitle"+a,refInFor:!0,attrs:{placeholder:"请输入大题名称"},model:{value:e.title,callback:function(i){t.$set(e,"title",i)},expression:"item.title"}})],1),t._v(" "),i("el-col",{attrs:{span:4}},[i("el-input",{staticClass:"paepr-input",attrs:{placeholder:"请输入大题说明"},model:{value:e.intro,callback:function(i){t.$set(e,"intro",i)},expression:"item.intro"}})],1),t._v(" "),i("el-col",{attrs:{span:3}},[i("el-select",{staticClass:"radom-item__select",attrs:{placeholder:"选择题型"},on:{change:function(i){return t.getRadomItemData(e)}},model:{value:e.tktype,callback:function(i){t.$set(e,"tktype",i)},expression:"item.tktype"}},t._l(t.questionTypes,function(t){return i("el-option",{key:t.tk_type,attrs:{label:t.type_name,value:t.tk_type,disabled:0==t.tk_num}})}),1)],1),t._v(" "),i("el-col",{staticClass:"ks-ml20",attrs:{span:-1}},[t._v("选取")]),t._v(" "),i("el-col",{attrs:{span:-1}},[i("ks-input-number",{attrs:{max:e.total,disabled:0==e.total,unit:"题"},on:{change:function(e){t.calculateBigQuestionScore(a),t.calculateTotalQuestionNumber()}},model:{value:e.tk_num,callback:function(i){t.$set(e,"tk_num",i)},expression:"item.tk_num"}})],1),t._v(" "),i("el-col",{attrs:{span:-1}},[t._v("共"+t._s(e.total)+"题")]),t._v(" "),i("el-col",{staticClass:"ks-ml20",attrs:{span:-1}},[t._v("每小题")]),t._v(" "),i("el-col",{attrs:{span:-1}},[i("ks-input-number",{attrs:{disabled:0==e.tk_num,unit:"分"},on:{change:function(e){t.calculateBigQuestionScore(a),t.calculateTotalQuestionNumber()}},model:{value:e.score,callback:function(i){t.$set(e,"score",i)},expression:"item.score"}})],1),t._v(" "),i("el-col",{attrs:{span:-1}},[i("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.delBigQuestion(a)}}},[t._v("删除")])],1)],1)}),1):i("div",{staticClass:"ks-empty"},[t._v("暂无题型")])]):t._e(),t._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.addTkType()}}},[t._v("添加大题")]),t._v(" "),i("div",{staticClass:"ks-mt20 ks-fz14"},[t._v("\n    发布状态  \n    "),i("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":t.$store.state.switch_on,"inactive-color":t.$store.state.switch_off},model:{value:t.is_open,callback:function(e){t.is_open=e},expression:"is_open"}})],1),t._v(" "),i("div",{staticClass:"paper-footer ks-mt20"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit()}}},[t._v("确认保存")]),t._v(" "),i("el-button",{on:{click:t.back}},[t._v("取消")])],1),t._v(" "),i("el-dialog",{attrs:{title:"编辑试卷",visible:t.editPaperVisible,width:"900px"},on:{"update:visible":function(e){t.editPaperVisible=e}}},[i("paper-add",{attrs:{"paper-id":t.paperId},on:{saved:t.paperSavedCall}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.getTkTypeName(t.typeValue),visible:t.selectQuestionVisible,width:"1100px"},on:{"update:visible":function(e){t.selectQuestionVisible=e}}},[i("question-list",{attrs:{action:"selectQuestion",tips:t.detail.categoryid>0?"当前仅显示该试卷所属分类【"+t.detail.categoryname+"】下的题目":"","selected-list":t.selectedTkids,"parentid-path":t.detail.parentidpath,"filter-type":t.typeValue},on:{callback:t.questionSelectedCall}})],1),t._v(" "),i("el-dialog",{attrs:{title:"随机抽题",width:"950px",visible:t.randomQuestionVisible},on:{"update:visible":function(e){t.randomQuestionVisible=e}}},[i("random-question",{attrs:{tips:t.detail.categoryid>0?"当前仅可抽取该试卷所属分类【"+t.detail.categoryname+"】下的题目，且已选题目无法重复抽取":"",categoryid:t.detail.categoryid,"selected-tkids":t.selectedTkids},on:{callback:t.randomSelectedCall}})],1),t._v(" "),i("el-dialog",{attrs:{width:"950px",title:"高级设置",visible:t.advancedSettingsVisible},on:{"update:visible":function(e){t.advancedSettingsVisible=e}}},[i("paper-set",{attrs:{"paper-id":t.paperId},on:{callback:function(e){t.advancedSettingsVisible=!1}}})],1)],1):t._e()},staticRenderFns:[]};var b=i("C7Lr")(_,k,!1,function(t){i("jIb7")},"data-v-1914116a",null);e.default=b.exports},jIb7:function(t,e){},lsLI:function(t,e){},olFL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("0xDb"),s=i("g+M4"),n=i("fNHR"),l={name:"PaperAdd",props:{paperId:{type:[String,Number],default:"0"}},watch:{paperId:function(){this.dataInit()}},data:function(){return{loaded:!1,showCategoryid:!1,formLabelAlign:{},parentidPath:[]}},methods:{onSubmit:function(){var t=this;Object(s.a)(this.formLabelAlign).then(function(e){"success"===e.result&&(t.$msg(e.msg,"success"),0==t.formLabelAlign.paperid?(t.$router.push({path:"/exam/addlist",query:{paperId:e.paperid,type:t.formLabelAlign.exam_type,scoreout:t.formLabelAlign.scoreout}}),setTimeout(function(){t.dataInit()},1e3)):t.$emit("saved",t.formLabelAlign))})},handleClassfiyChange:function(t){this.formLabelAlign.categoryid=t},reset:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.showCategoryid=!1,this.formLabelAlign={paperid:Object(a.e)(t.paperid,"0"),title:Object(a.e)(t.title),exam_type:Object(a.e)(t.exam_type,"2"),scoreout:Object(a.e)(t.scoreout,"1"),categoryid:Object(a.e)(t.categoryid,"0")},this.parentidPath=Object(a.e)(t.parentidpath,[])},dataInit:function(){var t=this;this.loaded=!1,this.$nextTick(function(){t.paperId>0?Object(s.h)({paperid:t.paperId}).then(function(e){t.reset(e.list),t.loaded=!0}):(t.reset(),t.loaded=!0)})}},created:function(){this.dataInit()},components:{PaperClassfiy:n.a}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.loaded?i("ks-container",[0==t.paperId?i("ks-title",{attrs:{name:"试卷添加",border:"none"}}):t._e(),t._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form",{attrs:{"label-width":"80px",model:t.formLabelAlign}},[i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.showCategoryid,expression:"showCategoryid"}],attrs:{label:"试卷类别"}},[null!==t.formLabelAlign.categoryid?i("paper-classfiy",{attrs:{categoryid:t.formLabelAlign.categoryid,"parentid-path":t.parentidPath,visible:t.showCategoryid},on:{change:t.handleClassfiyChange,"update:visible":function(e){t.showCategoryid=e}}}):t._e()],1),t._v(" "),i("el-form-item",{attrs:{label:"试卷名称"}},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.formLabelAlign.title,callback:function(e){t.$set(t.formLabelAlign,"title",e)},expression:"formLabelAlign.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"组卷方式"}},[i("el-radio",{attrs:{label:"2",disabled:t.paperId>0},model:{value:t.formLabelAlign.exam_type,callback:function(e){t.$set(t.formLabelAlign,"exam_type",e)},expression:"formLabelAlign.exam_type"}},[t._v("手动组卷")]),t._v(" "),i("el-radio",{attrs:{label:"1",disabled:t.paperId>0},model:{value:t.formLabelAlign.exam_type,callback:function(e){t.$set(t.formLabelAlign,"exam_type",e)},expression:"formLabelAlign.exam_type"}},[t._v("随机组卷")])],1),t._v(" "),i("el-form-item",{attrs:{label:"批阅方式"}},[i("el-radio",{attrs:{label:"2"},model:{value:t.formLabelAlign.scoreout,callback:function(e){t.$set(t.formLabelAlign,"scoreout",e)},expression:"formLabelAlign.scoreout"}},[t._v("教师批卷")]),t._v(" "),i("el-radio",{attrs:{label:"1"},model:{value:t.formLabelAlign.scoreout,callback:function(e){t.$set(t.formLabelAlign,"scoreout",e)},expression:"formLabelAlign.scoreout"}},[t._v("自主批卷")])],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)],1)],1):t._e()},staticRenderFns:[]},r=i("C7Lr")(l,o,!1,null,null,null);e.default=r.exports},tdgT:function(t,e){},xeox:function(t,e,i){"use strict";var a=i("++tE"),s=i("g+M4"),n=i("0xDb"),l=i("Ewv6"),o=i("fNHR"),r={name:"PaperAdd",props:{questionInfo:{type:Object,default:function(){return{}}},defaultParentidPath:{type:Array,default:function(){return[]}},update:{type:Boolean,default:!1},childQuestionIndex:{type:Number,default:-2},typeValue:[String,Number]},mixins:[a.a],data:function(){return{loaded:!1,showClassfiy:!0,categoryid:"0",parentidPath:[],stem:"",level:"中",tkinfo:{},childQuestions:[]}},watch:{update:function(t){t&&this.updateData()},stem:function(t,e){5==this.typeValue&&this.updateStemTags()}},methods:{handleTagClose:function(t,e){t.splice(e,1)},showTagInput:function(t,e){var i=this;t.inputVisible=!0,this.$nextTick(function(t){i.$refs["tag"+e][0].$refs.input.focus()})},handleTagConfirm:function(t){t.inputValue&&(t.dynamicTags.push(t.inputValue),t.inputValue="",t.inputVisible=!1)},updateStemTags:function(){var t=this;if(this.stem){var e=[];(this.stem.replace(/\<[^>]+>/gi,"").match(/_{3,}/g)||[]).map(function(i,a){t.tkinfo.answer[a]?e.push(t.tkinfo.answer[a]):e.push({optname:"第"+(a+1)+"空答案",dynamicTags:[],inputValue:"",inputVisible:!1})}),this.tkinfo.answer=e}},addOptions:function(){this.tkinfo.content.push({optionName:"选项"+(this.tkinfo.content.length+1),optionLeter:this.letters[this.tkinfo.content.length]})},delOption:function(){this.tkinfo.content.length>2?this.tkinfo.content.pop():this.$message({message:"选项不能小于两个，不能删除了",type:"warning"})},uploadAudio:function(){var t=this;this.$store.ready(function(e){t.$aliUpload({wxid:e.info.wxid,type:"examAudio",uploaded:function(e){t.tkinfo.audio_file=e.path,t.tkinfo.audio_file_name=e.file.name}})})},save:function(){var t=this;if(""==this.stem)return this.$msg("请填写题干"),this.$refs.stem.focus(),!1;var e=this.getTkInfo();if(1!=this.typeValue&&6!=this.typeValue&&""===e.answer.toString())return this.$msg("请填写答案"),!1;var i=this.questionInfo.tkid||0;if(-2===this.childQuestionIndex)Object(s.c)({categoryid:this.categoryid,title:this.stem,tktype:this.typeValue,tkid:i,level:this.getLevelValue(this.level),tkinfo:e}).then(function(e){"success"==e.result?i?(t.$msg("修改成功","success"),t.$emit("saved",{action:"editQuestion"})):(t.$msg("添加成功","success"),t.$emit("saved")):t.$msg(e.msg)});else if(this.childQuestionIndex>=-1){var a=Object(n.b)(this.childQuestions),l=this.getTkInfo(),o={title:this.stem,tktype:this.typeValue,level:this.level,tkinfo:l},r="添加成功";-1===this.childQuestionIndex?a.push(o):(a.splice(this.childQuestionIndex,1,o),r="修改成功"),Object(s.n)({tkid:i,tklist:a}).then(function(e){"success"===e.result&&(t.$msg(r,"success"),t.$emit("saved",{action:"addChildQuestion",tkid:i,childtk:a}))})}},getLevelValue:function(t){return["低","中","高"].indexOf(t)+1},getTkInfo:function(){var t=Object(n.b)(this.tkinfo);if(2==this.typeValue||3==this.typeValue){var e=[];t.content.map(function(t){e.push(t.optionName)}),t.content=e}else if(5==this.typeValue){var i=[];this.tkinfo.answer.map(function(t,e){t.dynamicTags&&i.push(t.dynamicTags)}),t.answer=i}return t},dataInit:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loaded=!1,this.$nextTick(function(){t.stem=e.title||"",t.level=e.level||"中",t.categoryid=e.categoryid||t.defaultParentidPath[t.defaultParentidPath.length-1]||"0";var i=e.tkinfo||{},a={};if(2==t.typeValue||3==t.typeValue){var s=[];if("Array"===Object(n.g)(i.content)&&i.content.length)i.content.map(function(e,i){s.push({optionName:e,optionLeter:t.letters[i]})});else for(var l=0;l<4;l++)s.push({optionName:"选项"+(l+1),optionLeter:t.letters[l]});a.content=s,3==t.typeValue?a.answer=i.answer||["A"]:a.answer=i.answer||"A"}else if(5==t.typeValue){var o=i.answer||[],r=[];o.length&&o.map(function(t,e){r.push({optname:"第"+(e+1)+"空答案",dynamicTags:t,inputValue:"",inputVisible:!1})}),a.answer=r}else 4==t.typeValue&&(a.answer=i.answer||0);a.analysis=i.analysis||"",a.audio_file_name=i.audio_file_name||"",a.audio_file=i.audio_file||"",t.tkinfo=a,t.parentidPath=e.parentidpath||t.defaultParentidPath,t.loaded=!0})},updateData:function(){-2===this.childQuestionIndex?this.dataInit(this.questionInfo):-1===this.childQuestionIndex?(this.dataInit(),this.childQuestions=this.questionInfo.tkinfo.childtk||[]):this.childQuestionIndex>=0&&(this.childQuestions=this.questionInfo.tkinfo.childtk,this.dataInit(this.questionInfo.tkinfo.childtk[this.childQuestionIndex]))},handleCategoryidChange:function(t){this.categoryid=t},upFieldOrder:function(t,e){var i=e[t-1],a=e[t],s=i.optionName,n=a.optionName;a.optionName=s,i.optionName=n},downFieldOrder:function(t,e){var i=e[t+1],a=e[t],s=i.optionName,n=a.optionName;a.optionName=s,i.optionName=n}},created:function(){this.updateData()},components:{PaperClassfiy:o.a}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loaded?i("div",{staticClass:"exam-container"},[i("el-form",{ref:"form",attrs:{"label-width":"120px"}},[-2===t.childQuestionIndex?i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.showClassfiy,expression:"showClassfiy"}],attrs:{label:"题目类别"}},[i("paper-classfiy",{attrs:{"parentid-path":t.parentidPath,visible:t.showClassfiy},on:{change:t.handleCategoryidChange,"update:visible":function(e){t.showClassfiy=e}}})],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:"题目信息"}},[i("ks-editor",{attrs:{"maximum-words":100},model:{value:t.stem,callback:function(e){t.stem=e},expression:"stem"}}),t._v(" "),5==t.typeValue?i("div",{staticClass:"ks-tips ks-color-warning ks-fz14 ks-mt10"},[t._v('提示：填空用连续三个下划线"_"表示，若一个空有多个参考答案，请添加同义词，学员答案匹配任意一个都算正确。')]):t._e(),t._v(" "),i("div",{staticClass:"exam-container__el-row ks-mt10"},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.uploadAudio}},[t._v("音频上传")]),t._v(" "),t.tkinfo.audio_file_name?i("div",{staticClass:"file_name"},[t._v(t._s(t.tkinfo.audio_file_name))]):t._e(),t._v(" "),i("div",{staticClass:"ks-tips"},[t._v("请注意您只能上传MP3、WMA格式的音频文件，文件最多可上传20M")])],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"题目解析"}},[i("ks-editor",{model:{value:t.tkinfo.analysis,callback:function(e){t.$set(t.tkinfo,"analysis",e)},expression:"tkinfo.analysis"}})],1),t._v(" "),2==t.typeValue||3==t.typeValue?i("el-form-item",{attrs:{label:"题目选项"}},t._l(t.tkinfo.content,function(e,a){return i("el-row",{key:e.optionLeter,staticClass:"exam-container__el-row"},[i("el-col",{attrs:{span:2}},[2==t.typeValue?i("el-radio",{attrs:{label:e.optionLeter},model:{value:t.tkinfo.answer,callback:function(e){t.$set(t.tkinfo,"answer",e)},expression:"tkinfo.answer"}},[t._v(t._s(e.optionLeter))]):i("el-checkbox",{attrs:{label:e.optionLeter},model:{value:t.tkinfo.answer,callback:function(e){t.$set(t.tkinfo,"answer",e)},expression:"tkinfo.answer"}},[t._v(t._s(e.optionLeter))])],1),t._v(" "),i("el-col",{attrs:{span:14}},[i("ks-editor",{attrs:{"maximum-words":100},model:{value:e.optionName,callback:function(i){t.$set(e,"optionName",i)},expression:"item.optionName"}})],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("div",{staticClass:"exam-item"},[i("el-col",{staticClass:"exam-item__el-col",attrs:{span:6}},[i("el-button",{attrs:{icon:"el-icon-plus",type:"danger",size:"small",circle:""},on:{click:function(e){return t.addOptions()}}})],1),t._v(" "),i("el-col",{staticClass:"exam-item__el-col",attrs:{span:6}},[i("el-button",{attrs:{icon:"el-icon-minus",type:"danger",size:"small",circle:""},on:{click:function(e){return t.delOption()}}})],1),t._v(" "),i("el-col",{staticClass:"exam-item__el-col",attrs:{span:6}},[i("el-button",{attrs:{type:"primary",size:"small",disabled:0===a,icon:"el-icon-arrow-up",circle:""},on:{click:function(e){return t.upFieldOrder(a,t.tkinfo.content)}}})],1),t._v(" "),i("el-col",{staticClass:"exam-item__el-col",attrs:{span:6}},[i("el-button",{attrs:{type:"primary",size:"small",disabled:a===t.tkinfo.content.length-1,icon:"el-icon-arrow-down",circle:""},on:{click:function(e){return t.downFieldOrder(a,t.tkinfo.content)}}})],1)],1)])],1)}),1):5==t.typeValue?i("el-form-item",t._l(t.tkinfo.answer,function(e,a){return i("div",{key:a},[i("div",{staticClass:"exam-container__addon"},[t._v(t._s(e.optname))]),t._v(" "),i("div",{staticClass:"exam-container__edir"},[t._l(e.dynamicTags,function(a,s){return i("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleTagClose(e.dynamicTags,s)}}},[t._v(t._s(a))])}),t._v(" "),e.inputVisible?i("el-input",{ref:"tag"+a,refInFor:!0,staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(i){return t.handleTagConfirm(e)}},model:{value:e.inputValue,callback:function(i){t.$set(e,"inputValue",i)},expression:"item.inputValue"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(i){return t.showTagInput(e,a)}}},[t._v("+ 同义词")])],2)])}),0):4==t.typeValue?i("el-form-item",{attrs:{label:"答案"}},[i("el-radio-group",{model:{value:t.tkinfo.answer,callback:function(e){t.$set(t.tkinfo,"answer",e)},expression:"tkinfo.answer"}},[i("el-radio",{attrs:{label:1}},[t._v("正确")]),t._v(" "),i("el-radio",{attrs:{label:0}},[t._v("错误")])],1)],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:"难度系数"}},[i("el-radio-group",{model:{value:t.level,callback:function(e){t.level=e},expression:"level"}},[i("el-radio",{attrs:{label:"低"}},[t._v("低")]),t._v(" "),i("el-radio",{attrs:{label:"中"}},[t._v("中")]),t._v(" "),i("el-radio",{attrs:{label:"高"}},[t._v("高")])],1)],1)],1),t._v(" "),i("div",{attrs:{align:"center"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1):i("div",{staticClass:"exam-container__loading"},[i("ks-loading")],1)])},staticRenderFns:[]};var u={name:"TKList",components:{ChoiceQuestion:i("C7Lr")(r,c,!1,function(t){i("GMUD")},"data-v-ee0e15b2",null).exports,PaperLead:l.default},mixins:[a.a],props:{action:String,filterType:{type:[String,Number],default:"0"},tips:String,parentidPath:{type:Array,default:function(){return["0"]}},selectedList:{type:Array,default:function(){return[]}}},data:function(){return{loaded:!0,paperLeadVisible:!1,pagination:{total:1,current:1},activeName:"second",keyword:"",currentTkType:this.filterType,tableData:[],typeValue:"",choiceQuesionVisible:!1,difficult:[{value:"0",label:"不限"},{value:"1",label:"低"},{value:"2",label:"中"},{value:"3",label:"高"}],tkhard:"0",questionInfo:{},childQuestionIndex:-2}},methods:{getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$showLoading();var i={p:e,level:this.tkhard,tktype:this.currentTkType,maxperpage:10,keyword:this.keyword};i.categoryid=this.parentidPath[this.parentidPath.length-1]||"0",Object(s.m)(i).then(function(e){e.list.map(function(t){t.checked=!1,t.disabled=!1,t.showFlag=!1}),t.tableData=e.list,t.setSelectedDisabled(),t.pagination.current=e.page.now_page,t.pagination.total=e.page.total_pages,t.$hideLoading()})},setSelectedDisabled:function(){var t=this;this.tableData.map(function(e){var i=!1;t.selectedList.map(function(t){t==e.tkid&&(i=!0)}),i?(e.checked=!0,e.disabled=!0):(e.checked=!1,e.disabled=!1)})},handleTkSaved:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.choiceQuesionVisible=!1,"addChildQuestion"===t.action?this.tableData.map(function(e){e.tkid==t.tkid&&(e.showFlag=!0,e.tkinfo.childtk=t.childtk)}):"editQuestion"===t.action?this.getList(this.pagination.current):this.getList()},handleCommand:function(t){2==t.type?this.del([t.id]):(this.questionInfo=Object(n.b)(t.data),this.childQuestionIndex=-2,this.typeValue=t.data.tktype,this.choiceQuesionVisible=!0)},del:function(t){var e=this;Object(s.g)({type:2,id:t}).then(function(t){"success"==t.result?(e.$msg("删除成功","success"),e.getList(e.pagination.current)):e.$msg("删除失败")})},addChildQuestion:function(t){this.questionInfo=t.info,this.childQuestionIndex=-1,this.typeValue=t.tktype,this.choiceQuesionVisible=!0},addQuestionCommand:function(t){this.addQuestion(t.id)},addQuestion:function(t){this.childQuestionIndex=-2,this.questionInfo={},this.typeValue=t,this.choiceQuesionVisible=!0},handleTabClick:function(t){"试卷"==t.label&&this.$router.push("/?url=/home.html/exam/Index?appid-10")},save:function(){var t=[];this.tableData.map(function(e){e.checked&&!1===e.disabled&&t.push(e)}),this.$emit("callback",t)},spread:function(t){t.showFlag?t.showFlag=!1:t.showFlag=!0},makeDel:function(t,e,i){var a=this,l=Object(n.b)(t);l.splice(e,1),Object(s.n)({tkid:i,tklist:l}).then(function(i){"success"===i.result&&(a.$msg("删除成功","success"),t.splice(e,1))})},editCombinationQuestion:function(t,e,i){this.questionInfo=t,this.typeValue=e,this.childQuestionIndex=i,this.choiceQuesionVisible=!0}},created:function(){this.getList()},activated:function(){this.activeName="second"},watch:{filterType:function(t){this.currentTkType=t,this.getList()},selectedList:{handler:function(){this.setSelectedDisabled()},deep:!0}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",["selectQuestion"!==t.action?i("el-row",[[i("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"试卷",name:"first"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"题库",name:"second"}})],1)]],2):t._e(),t._v(" "),t.tips?i("el-alert",{attrs:{title:t.tips,type:"warning",closable:!1}}):t._e(),t._v(" "),i("el-row",{staticClass:"ks-pt20 ks-pd20"},[i("el-col",{attrs:{span:18}},[i("el-select",{staticClass:"ks-w150",attrs:{placeholder:"请选择难度"},on:{change:function(e){return t.getList()}},model:{value:t.tkhard,callback:function(e){t.tkhard=e},expression:"tkhard"}},t._l(t.difficult,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),"selectQuestion"!==t.action?i("el-select",{staticClass:"ks-w150",attrs:{placeholder:"请选择题目类型"},on:{change:function(e){return t.getList()}},model:{value:t.currentTkType,callback:function(e){t.currentTkType=e},expression:"currentTkType"}},[i("el-option",{attrs:{label:"不限",value:"0"}}),t._v(" "),t._l(t.tkTypes,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2):t._e(),t._v(" "),i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},on:{change:function(e){return t.getList()}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[i("i",{staticClass:"el-icon-search el-input__icon ks-cursor-pointer",attrs:{slot:"suffix"},on:{click:function(e){return t.getList()}},slot:"suffix"})])],1),t._v(" "),i("el-col",{attrs:{span:6,align:"right"}},["selectQuestion"!==t.action?i("el-button",{staticClass:"ks-mr10",attrs:{type:"primary"},on:{click:function(e){t.paperLeadVisible=!0}}},[t._v("题目导入")]):t._e(),t._v(" "),"selectQuestion"===t.action?i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addQuestion(t.currentTkType)}}},[t._v("添加"+t._s(t.getTkTypeName(t.currentTkType)))]):i("el-dropdown",{on:{command:t.addQuestionCommand}},[i("el-button",{attrs:{type:"primary"}},[t._v("\n          添加题目\n          "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.tkTypes,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:e}},[i("div",{on:{click:function(i){return t.addQuestion(e.id)}}},[t._v(t._s(e.name))])])}),1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark"}},[i("el-table-column",{attrs:{label:"选择",width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-checkbox",{attrs:{disabled:e.row.disabled},model:{value:e.row.checked,callback:function(i){t.$set(e.row,"checked",i)},expression:"scope.row.checked"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{type:"index",width:"55",label:"序号"}}),t._v(" "),i("el-table-column",{attrs:{prop:"level",label:"难度",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{label:"题目类型",prop:"type_name",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{label:"题目分类",prop:"categoryname",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{label:"题目"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"item-content"},[t._v("\n              "+t._s(t._f("filterHtml")(e.row.title))+"\n              "),i("span",{on:{click:function(i){return t.spread(e.row)}}},[i("i",{staticClass:"expand ks-color-link"},[t._v(t._s(e.row.showFlag?"【关闭】":"【展开】"))])]),t._v(" "),6==e.row.tktype?i("span",[i("el-dropdown",{on:{command:t.addChildQuestion}},[i("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("\n                    添加小题\n                    "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.tkTypes,function(a){return i("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:6!=a.id,expression:"item.id != 6"}],key:a.id,attrs:{command:{info:e.row,tktype:a.id}}},[t._v(t._s(a.name))])}),1)],1)],1):t._e(),t._v(" "),e.row.showFlag?i("div",{staticClass:"analysis"},[i("div",[i("div",{staticClass:"black-box"},[1!=e.row.tktype&&6!=e.row.tktype?i("div",[t._v("\n                      答案："+t._s(t._f("filterAnswer")(e.row.tkinfo.answer,e.row.tktype))+"\n                    ")]):t._e(),t._v(" "),6!=e.row.tktype?i("div",{staticClass:"black-title"},[t._v("解析："+t._s(t._f("filterHtml")(e.row.tkinfo.analysis)))]):t._e()])]),t._v(" "),e.row.tkinfo.childtk?i("div",t._l(e.row.tkinfo.childtk,function(a,s){return i("div",{key:s,staticClass:"small-question"},[i("div",{staticClass:"black-box"},[i("div",{staticClass:"black-font"},[t._v("第"+t._s(s+1)+"小题")]),t._v(" "),i("div",{staticClass:"black-title"},[t._v("【"+t._s(t.getTkTypeName(a.tktype))+"】"+t._s(t._f("filterHtml")(a.title)))])]),t._v(" "),i("div",{staticClass:"black-box"},[1!=a.tktype?i("div",[t._v("\n                        答案："+t._s(t._f("filterAnswer")(a.tkinfo.answer,a.tktype))+"\n                      ")]):t._e()]),t._v(" "),i("div",{staticClass:"black-title"},[t._v("解析："+t._s(t._f("filterHtml")(a.tkinfo.analysis)))]),t._v(" "),i("div",{staticClass:"black-box"},[i("span",{staticClass:"black-font"},[t._v("操作")]),t._v(" "),i("span",{staticClass:"expand ks-color-link",on:{click:function(i){return t.editCombinationQuestion(e.row,a.tktype,s)}}},[t._v("【编辑】")]),t._v(" "),i("span",{staticClass:"expand ks-color-link",on:{click:function(i){return t.makeDel(e.row.tkinfo.childtk,s,e.row.tkid)}}},[t._v("【删除】")])])])}),0):t._e()]):t._e()])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"adddate",label:"添加时间",width:"200"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("span",{staticClass:"el-dropdown-link"},[i("i",{staticClass:"el-icon-more"})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:{type:"1",data:e.row}}},[t._v("编辑")]),t._v(" "),i("el-dropdown-item",{attrs:{command:{type:"2",id:e.row.tkid}}},[t._v("删除")])],1)],1)]}}])})],1)],1)],1),t._v(" "),i("el-dialog",{attrs:{visible:t.paperLeadVisible,"append-to-body":!0},on:{"update:visible":function(e){t.paperLeadVisible=e}}},[i("paper-lead",{on:{success:function(e){t.paperLeadVisible=!1,t.getList()}}})],1),t._v(" "),i("el-dialog",{attrs:{width:"950px",title:t.getTkTypeName(t.typeValue),visible:t.choiceQuesionVisible,"append-to-body":!0},on:{"update:visible":function(e){t.choiceQuesionVisible=e}}},[i("choice-question",{attrs:{update:t.choiceQuesionVisible,"question-info":t.questionInfo,"type-value":t.typeValue,"child-question-index":t.childQuestionIndex,"default-parentid-path":t.parentidPath},on:{"update:update":function(e){t.choiceQuesionVisible=e},saved:t.handleTkSaved}})],1),t._v(" "),i("div",{staticClass:"ks-mt20 ks-pl10"},["selectQuestion"!==t.action?i("ks-table-footer",{attrs:{pagination:t.pagination,"table-data":t.tableData,"call-type":"array","select-key":"tkid"},on:{"current-change":t.getList,trigger:t.del}}):i("ks-table-footer",{attrs:{"customize-button":{text:"确定"},pagination:t.pagination,"table-data":t.tableData,"call-type":"array","select-key":"tkid"},on:{"current-change":t.getList,trigger:t.save}})],1)],1)},staticRenderFns:[]};var p=i("C7Lr")(u,d,!1,function(t){i("/PUX")},"data-v-ea42f840",null);e.a=p.exports}});