webpackJsonp([18],{DduK:function(t,i){},V9to:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("w8io"),s=e("dAT0"),n=e("g+M4"),c={name:"ExamResult",components:{PaperMedal:s.a,cavansPopups:a.a},data:function(){return{certificate:{share_title:"",title:"",json:{comment:""},cover:"",qrcode:""},loaded:!1,accuracy:0,iscorrect:0,answerSheet:[],id:0,type:0,correctscore:0,sumscore:0}},activated:function(){var t=this;document.title="",this.answerSheet=[],this.id=this.$route.query.id,this.type=this.$route.query.type;Object(n.k)({answerid:this.id,type:this.type}).then(function(i){if("success"==i.result){if(document.title=i.detail.title,t.iscorrect=i.detail.iscorrect,t.accuracy=i.detail.accuracy,i.detail.certificate&&i.detail.certificate.id){var e=t.certificate;e.share_title=i.detail.certificate.share_title,e.title=i.detail.certificate.title,e.json.comment=i.detail.certificate.json.comment,e.cover=i.detail.certificate.cover,e.qrcode=i.detail.certificate.qrcode,e.id=i.detail.certificate.id,e.sumscore=i.detail.certificate.sumscore,e.info_title=i.detail.title}var a=[];i.detail.answer.map(function(t,e){t.tklist&&t.tklist.map(function(t){0==i.iscorrect&&(t.userscore>0?t.right=1:t.right=0),t.useranswer&&""!==t.useranswer.toString()?t.doing=1:t.doing=0,a.push(t)})}),t.answerSheet=a,t.sumscore=i.detail.sumscore}t.loaded=!0})},methods:{seeCertificate:function(){var t=this;this.$nextTick(function(){t.$refs.certificate.getcanvas()})},viewAnalysis:function(){this.$router.push({path:"/exam/analysis",query:{id:this.id,type:this.type}})},practice:function(){this.$router.push("/exam")}}},r={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return t.loaded?a("div",[1==t.type?a("paper-medal",{attrs:{value:1==t.iscorrect?t.sumscore:"",unit:1==t.iscorrect?"":"未批阅",name:"得分"}}):2==t.type?a("paper-medal",{attrs:{value:t.accuracy,unit:"%",name:"正确率"}}):t._e(),t._v(" "),t.certificate&&t.certificate.id?a("div",{staticClass:"certificate"},[a("div",[a("span",{staticClass:"certificate-left"},[a("img",{staticClass:"certificate-left__img",attrs:{src:e("gWa6"),alt:""}}),t._v("\n          获得"),a("span",{staticClass:"certificate-left__name"},[t._v(" "+t._s(t.certificate.title)+" ")]),t._v("证书\n        ")])]),t._v(" "),a("div",[a("span",{staticClass:"certificate-see",on:{click:t.seeCertificate}},[t._v("查看证书")])])]):t._e(),t._v(" "),t._m(0),t._v(" "),a("div",{staticClass:"paper-contianer"},[t.answerSheet.length?a("div",{staticClass:"paper-answer"},t._l(t.answerSheet,function(i,e){return a("div",{key:e,staticClass:"paper-answer__item",class:{doing:1==i.doing,error:"wrong"==i.mark,right:"right"==i.mark}},[t._v(t._s(e+1)+"\n      ")])}),0):t._e()]),t._v(" "),a("div",{staticClass:"paper-submit-box"},[a("div",{staticClass:"paper-submit paper-submit--default",on:{click:function(i){return t.viewAnalysis()}}},[t._v("查看解析")]),t._v(" "),a("div",{staticClass:"paper-submit",on:{click:t.practice}},[t._v("返回练习主页")])]),t._v(" "),a("cavansPopups",{ref:"certificate",attrs:{info:t.certificate}})],1):t._e()},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"paper-opear clearfix"},[i("div",{staticClass:"paper-opear__right"},[i("div",{staticClass:"paper-icon-sign paper-icon-sign--color1"},[i("i"),this._v("已做\n      ")]),this._v(" "),i("div",{staticClass:"paper-icon-sign paper-icon-sign--color5"},[i("i"),this._v("正确\n      ")]),this._v(" "),i("div",{staticClass:"paper-icon-sign paper-icon-sign--color2"},[i("i"),this._v("错误\n      ")]),this._v(" "),i("div",{staticClass:"paper-icon-sign paper-icon-sign--color3"},[i("i"),this._v("未做\n      ")])])])}]};var o=e("C7Lr")(c,r,!1,function(t){e("DduK")},"data-v-477ed25d",null);i.default=o.exports},gWa6:function(t,i,e){t.exports=e.p+"static/img/certificateImg.cbfe953.png"},sHW7:function(t,i){},w8io:function(t,i,e){"use strict";var a=e("rVsN"),s=e.n(a),n=new Object;n.init=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.ctx=t.ctx,this.width=t.width,this.height=t.height},n.circleImg=function(t,i,e,a,s){var n=Math.min(e,a);s>n/2&&(s=n/2),this.ctx.beginPath(),this.ctx.moveTo(t+s,i),this.ctx.arcTo(t+e,i,t+e,i+a,s),this.ctx.arcTo(t+e,i+a,t,i+a,s),this.ctx.arcTo(t,i+a,t,i,s),this.ctx.arcTo(t,i,t+e,i,s),this.ctx.closePath()},n.draw=function(t,i){var e=this.ctx.createPattern(t,"no-repeat");this.circleImg(i.x,i.y,i.width,i.height,1*i.radius||0),this.ctx.fillStyle=e,this.ctx.fill()},n.drawImage=function(t,i){var e=this;return new s.a(function(a){var s=new Image;s.crossOrigin="Anonymous",s.src=t,i.x=i.x||0,i.y=i.y||0,i.radius=i.radius||0,i.width=i.width||e.width,i.height=i.height||e.height,s.onload=function(){i.radius?function(t,i,e,a,s){t.save();var n=2*s,c=e+s,r=a+s;t.arc(c,r,s,0,2*Math.PI),t.clip(),t.drawImage(i,e,a,n,n),t.restore()}(e.ctx,s,i.x,i.y,i.width/2):e.ctx.drawImage(s,i.x,i.y,i.width,i.height),a()}})},n.fillText=function(t){var i=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.fontSize=e.fontSize||14,e.fontWeight=e.fontWeight||"bold",e.fontStyle=e.fontStyle||"Arial",e.x=e.x||0,e.y=e.y||0,e.padding=e.padding||0,e.fillStyle=e.fillStyle||"black",this.ctx.fillStyle=e.fillStyle,this.ctx.fontWeight=e.fontWeight,t){var a=t.match(/[\u4e00-\u9fa5]/g),s=Number(t.length),n=void 0;n=a&&a.length?Number(a.length):0;var c=Number(e.fontSize),r=s-n;a&&a.length&&r?n*c+r*c/2:a?a.length*c:r*c/2;for(var o=Math.floor((this.width-2*e.padding-e.x)/e.fontSize),h=t.split(""),l=0,d=[],f=0,v=0;v<t.length;v++){var g=c/2;h[v].charCodeAt()>127||94==h[v].charCodeAt()?(l+=2,g*=2):l++,l/2<=o?d[f]?d[f]={text:d[f].text+t.substr(v,1),w:d[f].w+g}:d[f]={text:t.substr(v,1),w:g}:(d[f+=1]={text:t.substr(v,1),w:g},l=0)}this.ctx.font=e.fontSize+"px  "+e.fontStyle,d.map(function(t,a){e.x||(e.x=(i.width-t.w)/2),i.ctx.fillText(t.text,e.x,e.y+a*c)})}};var c=n,r={props:{info:Object},data:function(){return{flag:!1,canvasWidth:.88*window.innerWidth*4,canvasHeight:.88*window.innerWidth/.66*4,canImg:""}},methods:{getcanvas:function(){var t=this;this.$showLoading();var i=Math.ceil(1e7*Math.random()),e=this.$refs.myCanvas,a={ctx:e.getContext("2d"),width:this.canvasWidth,height:this.canvasHeight};c.init(a),c.drawImage(this.info.cover+"?"+i,{width:this.canvasWidth,height:this.canvasHeight,containerWidth:.8*this.canvasWidth}).then(function(){c.drawImage(t.$store.state.userInfo.headimg+"?"+i,{x:.406*t.canvasWidth,y:.262*t.canvasHeight,width:.187*t.canvasWidth,height:.11*t.canvasHeight,radius:40}).then(function(){c.drawImage(t.info.qrcode+"?"+i,{x:.164*t.canvasWidth,y:.76*t.canvasHeight,width:.233*t.canvasWidth,height:.137*t.canvasHeight}).then(function(){var i;i="/Public/app/images/certificate_bg2.png"==t.info.cover?"white":"black",c.fillText(t.info.title,{fontSize:72,padding:30,y:.235*t.canvasHeight,fillStyle:i}),c.fillText(t.$store.state.userInfo.nickname,{fontSize:64,padding:30,y:.425*t.canvasHeight,fillStyle:i}),c.fillText("在"+t.info.info_title+"获得了"+t.info.sumscore+"分",{fontSize:64,padding:30,y:.471*t.canvasHeight,fillStyle:i}),c.fillText(t.info.json.comment,{fontSize:64,padding:30,y:.606*t.canvasHeight,fillStyle:i}),c.fillText("asdasdaasdas",{padding:30,x:.44*t.canvasWidth,y:.8*t.canvasHeight,fillStyle:i,fontSize:56}),c.fillText("长按保存二维码",{padding:30,x:.44*t.canvasWidth,y:.88*t.canvasHeight,fillStyle:"#bdbdb0",fontSize:56})}).then(function(){t.canImg=e.toDataURL("image/png"),t.flag=!0,t.$hideLoading()})})})}}},o={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("van-overlay",{attrs:{show:t.flag},on:{click:function(i){t.flag=!1}}},[e("div",{staticClass:"Canvas"},[e("canvas",{ref:"myCanvas",staticClass:"canvas-can",attrs:{width:t.canvasWidth,height:t.canvasHeight}})]),t._v(" "),e("div",{staticClass:"canImg"},[t.canImg?e("img",{staticClass:"canImg-image",style:{width:t.canvasWidth/4+"px",height:t.canvasHeight/4+"px"},attrs:{src:t.canImg}}):t._e()]),t._v(" "),e("div",{staticClass:"operation"},[e("p",[t._v("长按保存图片，发微信好友或微信群")])])])],1)},staticRenderFns:[]};var h=e("C7Lr")(r,o,!1,function(t){e("sHW7")},"data-v-07c9917b",null);i.a=h.exports}});