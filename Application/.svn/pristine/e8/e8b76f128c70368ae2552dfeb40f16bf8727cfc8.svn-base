webpackJsonp([22],{"8sD7":function(e,t){},FqZW:function(e,t){},"rBl+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("4YfN"),i=n.n(a),s=n("rVsN"),r=n.n(s),l=n("60kx");var o={name:"dialogShare",props:{dialogVisible:{type:Boolean,default:!1},shareObj:{type:Object}},methods:{sharePoster:function(){this.$message({message:"开发中",type:"warning"})},handleClose:function(){this.$emit("closeShare")}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"分享",visible:e.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.shareObj?n("div",{staticClass:"share-dialog-container"},[n("div",{staticClass:"share-dialog-container__header"},[n("section",[n("span",{style:{color:"link"==e.shareObj.way?"#409eff":""}},[e._v("分享链接")]),e._v(" "),n("span",{style:{color:"link"!=e.shareObj.way?"#409eff":""},on:{click:e.sharePoster}},[e._v("分享海报")])])]),e._v(" "),n("div",{staticClass:"share-dialog-container__main"},[n("div",{staticClass:"by-link"},[n("h4",[e._v("方法一 : 通过链接")]),e._v(" "),n("p",[e._v("分享此链接到微信群和微信好友")]),e._v(" "),n("p",{staticClass:"link"},[e._v(e._s(e.shareObj.link))]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"small"}},[e._v("复制链接")])],1),e._v(" "),n("div",{staticClass:"by-qr-code"},[n("h4",[e._v("方法二 : 通过二维码")]),e._v(" "),n("img",{attrs:{src:e.shareObj.qrCode}})])])]):e._e(),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})])},staticRenderFns:[]};var u={name:"PleaseFriend",components:{dialogShare:n("C7Lr")(o,c,!1,function(e){n("8sD7")},"data-v-69a768ee",null).exports},data:function(){return{loading:!1,activeName:"friendManage",activeStatusIndex:0,dialogVisible:!1,freeid:null,freeList:[],freeListPage:null,freeListCurrentPage:1,shareDialog:!1,shareObj:null,freeOrderList:[],freeOrderListPage:null,freeOrderListCurrentPage:1,addCourseList:[],addCourseName:"",courseid:null,single_content_num:1,same_person_num:1}},computed:{formatTimestamp:function(){return function(e){if(0==e)return"";var t=new Date(parseInt(e)),n=t.getFullYear(),a=t.getMonth()+1,i=t.getDate(),s=t.getHours(),r=t.getMinutes(),l=t.getSeconds();return a=a<10?"0"+a:a,i=i<10?"0"+i:i,s=s<10?"0"+s:s,r=r<10?"0"+r:r,l=l<10?"0"+l:l,n+"."+a+"."+i+" "+s+":"+r}},disabledCourse:function(){return function(e){this.freeList.some(function(t){return t.courseid==e})}}},activated:function(){this.loading=!1,this.activeName="friendManage",this.getFreeList()},methods:{handleClick:function(e,t){"friendManage"==this.activeName?this.getFreeList():"friendOrder"==this.activeName&&this.getFreeOrderList()},showStatusList:function(e){"friendManage"==this.activeName&&(this.activeStatusIndex=e,this.getFreeList({status:e}))},addFriendHelp:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",n=arguments[1];(function(e){return new r.a(function(t){Object(l.b)("FreeLook.courseList",e).then(function(e){t(e)})})})("add"==t?{}:{freeid:n.id}).then(function(a){e.addCourseList=a,"add"==t?(e.freeid=null,e.addCourseName="",e.single_content_num=1,e.same_person_num=1):"edit"==t&&(e.freeid=n.id,e.courseid=n.json.courseid,e.addCourseName=n.course_title,e.single_content_num=1*n.json.single_content_num,e.same_person_num=1*n.json.same_person_num),e.dialogVisible=!0})},confirmAddColumn:function(){var e=this;if(null==this.courseid)return this.$msg("课程名称不能为空"),this.$refs.courseid.focus(),!1;if(!this.single_content_num)return this.$msg("可以免费邀请的学习的好友数不能为空"),this.$refs.single_content_num.focus(),!1;if(!this.same_person_num)return this.$msg("同一个好友可领取的节数"),this.$refs.single_content_num.focus(),!1;var t={json:{courseid:this.courseid,single_content_num:this.single_content_num,same_person_num:this.same_person_num}};this.freeid&&(t.freeid=this.freeid),function(e){return new r.a(function(t){Object(l.b)("FreeLook.addFree",e).then(function(e){t(e)})})}(t).then(function(t){e.getFreeList(),e.dialogVisible=!1})},deleteFriendHelp:function(e){var t,n=this;(t={freeid:e.id},new r.a(function(e){Object(l.b)("FreeLook.delFree",t).then(function(t){e(t)})})).then(function(e){n.getFreeList(),n.dialogVisible=!1})},getCourseName:function(e){this.courseid=e},handleShare:function(e){var t,n=this;this.shareObj=null,(t={courseid:e.json.courseid},new r.a(function(e){Object(l.b)("FreeLook.shareFree",t).then(function(t){e(t)})})).then(function(e){var t={way:"link",link:e.link,qrCode:e.qrcode};n.shareObj=t,n.shareDialog=!0})},changeSatus:function(e){var t,n=this;(t={freeid:e.id},new r.a(function(e){Object(l.b)("FreeLook.changeFree",t).then(function(t){e(t)})})).then(function(e){n.getFreeList()})},freeListPageChange:function(e){this.freeListCurrentPage=e,this.getFreeList({p:e})},freeOrderListPageChange:function(e){this.freeOrderListCurrentPage=e,this.getFreeOrderList({p:e})},getFreeList:function(e){var t=this,n={status:"",p:this.freeListCurrentPage,maxperpage:10};(function(e){return new r.a(function(t){Object(l.b)("FreeLook.freeList",e).then(function(e){t(e)})})})(i()({},n,e)).then(function(e){t.freeList=e.list,t.freeListPage=e.page,t.loading=!0})},getFreeOrderList:function(e){var t=this;(function(e){return new r.a(function(t){Object(l.b)("FreeLook.freeOrderList",e).then(function(e){t(e)})})})(i()({},{status:"",p:1,maxperpage:10},e)).then(function(e){t.freeOrderList=e.list,t.freeOrderListPage=e.page,t.loading=!0})}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.loading?n("ks-container",[n("ks-title",{attrs:{name:"免费请好友看",border:"none"}}),e._v(" "),n("div",{staticClass:"friend-con"},[n("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"免费请好友看管理",name:"friendManage"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.freeList,"tooltip-effect":"dark"}},[n("el-table-column",{attrs:{prop:"course_title",label:"课程活动",align:"center","min-width":"200"}}),e._v(" "),n("el-table-column",{attrs:{label:"免费名额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"active-status"},[e._v(e._s(t.row.json.single_content_num))]),e._v("人\n\t\t\t\t\t\t\t")]}}],null,!1,1626542178)}),e._v(" "),n("el-table-column",{attrs:{prop:"json.same_person_num",label:"同一好友最多可领取数",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"initiatenum",label:"已分享次数",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"helpnum",label:"已领取数",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"创建时间",align:"center","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.formatTimestamp(1e3*t.row.createtime)))])]}}],null,!1,113653232)}),e._v(" "),n("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-color":"#13ce66"},on:{change:function(n){return e.changeSatus(t.row)}},model:{value:t.row.status,callback:function(n){e.$set(t.row,"status",n)},expression:"scope.row.status"}})]}}],null,!1,2295762637)}),e._v(" "),n("el-table-column",{attrs:{label:"推广",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{staticClass:"iconfont icon-fen-xiang table-share",on:{click:function(n){return e.handleShare(t.row)}}})]}}],null,!1,2152108761)}),e._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-dropdown",{attrs:{trigger:"click",placement:"bottom"}},[n("span",{staticClass:"table-operation"},[e._v("...")]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("span",{on:{click:function(n){return e.addFriendHelp("edit",t.row)}}},[n("el-dropdown-item",{staticStyle:{"text-align":"center"}},[e._v("编辑")])],1),e._v(" "),n("span",{on:{click:function(n){return e.deleteFriendHelp(t.row)}}},[n("el-dropdown-item",{staticStyle:{"text-align":"center"}},[e._v("删除")])],1)])],1)]}}],null,!1,1499870301)})],1),e._v(" "),n("el-pagination",{staticClass:"table-page",attrs:{background:"",layout:"prev, pager, next",total:+e.freeListPage.totalput,"page-size":+e.freeListPage.maxperpage},on:{"current-change":e.freeListPageChange}})],1),e._v(" "),n("el-tab-pane",{attrs:{label:"免费请好友看订单",name:"friendOrder"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.freeOrderList,"tooltip-effect":"dark"}},[n("el-table-column",{attrs:{prop:"userid",label:"用户ID",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"用户昵称",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"mobile",label:"手机号",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"course_title",label:"分享专栏",align:"center","min-width":"150"}}),e._v(" "),n("el-table-column",{attrs:{prop:"chapter_title",label:"分享的章节",align:"center","min-width":"150"}}),e._v(" "),n("el-table-column",{attrs:{label:"领取次数",align:"center","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("span",{staticClass:"active-status"},[e._v(e._s(t.row.receive_count))]),e._v("/"),n("span",[e._v(e._s(t.row.single_content_num))])])]}}],null,!1,3574831346)}),e._v(" "),n("el-table-column",{attrs:{label:"分享时间",align:"center","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.formatTimestamp(1e3*t.row.createtime)))])]}}],null,!1,113653232)}),e._v(" "),n("el-table-column",{attrs:{prop:"ip",label:"IP",align:"center"}})],1),e._v(" "),e.freeOrderListPage?n("el-pagination",{staticClass:"table-page",attrs:{background:"",layout:"prev, pager, next",total:+e.freeOrderListPage.totalput,"page-size":+e.freeOrderListPage.maxperpage},on:{"current-change":e.freeOrderListPageChange}}):e._e()],1)],1),e._v(" "),n("div",{staticClass:"friend-con-addhelp"},[n("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click",disabled:"friendManage"!=e.activeName}},[n("div",[n("span",[e._v("状态 :")]),e._v(" "),n("span",{class:0==e.activeStatusIndex?"active-status":"",on:{click:function(t){return e.showStatusList(0)}}},[e._v("不限")]),e._v(" "),n("span",{class:1==e.activeStatusIndex?"active-status":"",on:{click:function(t){return e.showStatusList(1)}}},[e._v("已开启")]),e._v(" "),n("span",{class:2==e.activeStatusIndex?"active-status":"",on:{click:function(t){return e.showStatusList(2)}}},[e._v("未开启")])]),e._v(" "),n("el-button",{attrs:{slot:"reference",type:"primary",icon:"iconfont icon-filter",size:"small"},slot:"reference"})],1),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"iconfont icon-plus",size:"small"},on:{click:function(t){return e.addFriendHelp("add")}}},[e._v("添加请好友看")])],1)],1),e._v(" "),n("el-dialog",{staticClass:"add-dialog",attrs:{visible:e.dialogVisible,width:"50%","show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{attrs:{model:e.addCourseList,"label-width":"220px"}},[n("div",{staticClass:"el-form-item-title"},[e._v("添加课程")]),e._v(" "),n("el-form-item",{attrs:{label:"【选择课程】"}},[n("el-select",{ref:"courseid",staticStyle:{width:"60%"},attrs:{placeholder:"请选择添加课程"},on:{change:e.getCourseName},model:{value:e.addCourseName,callback:function(t){e.addCourseName=t},expression:"addCourseName"}},e._l(e.addCourseList,function(t,a){return n("el-option",{key:a,attrs:{label:t.title,value:t.courseid,disabled:e.disabledCourse(t.courseid)}})}),1),e._v(" "),n("div",{staticClass:"el-form-item-tip"},[e._v("购买课程后的用户才有免费请好友看的权限")])],1),e._v(" "),n("div",{staticClass:"el-form-item-title"},[e._v("设置")]),e._v(" "),n("el-form-item",{attrs:{label:"可以免费邀请的学习的好友数"}},[n("ks-input-number",{ref:"single_content_num",staticStyle:{"max-width":"60%"},attrs:{min:1},model:{value:e.single_content_num,callback:function(t){e.single_content_num=t},expression:"single_content_num"}}),e._v(" "),n("div",{staticClass:"el-form-item-tip"},[e._v("超过次数需用户付费购买赠送课程")])],1),e._v(" "),n("el-form-item",{attrs:{label:"同一个好友可领取的节数"}},[n("ks-input-number",{ref:"same_person_num",staticStyle:{"max-width":"60%"},attrs:{min:1},model:{value:e.same_person_num,callback:function(t){e.same_person_num=t},expression:"same_person_num"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmAddColumn}},[e._v("确 定")])],1)],1),e._v(" "),n("dialogShare",{attrs:{dialogVisible:e.shareDialog,shareObj:e.shareObj},on:{closeShare:function(t){e.shareDialog=!1}}})],1):e._e()},staticRenderFns:[]};var f=n("C7Lr")(u,d,!1,function(e){n("FqZW")},"data-v-59bd6be6",null);t.default=f.exports}});