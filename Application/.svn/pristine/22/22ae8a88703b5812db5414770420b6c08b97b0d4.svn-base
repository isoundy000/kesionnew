webpackJsonp([29],{EIOx:function(t,e,i){"use strict";e.a=function(t){return new n.a(function(e){Object(s.b)("FriendsHelp.addMarket",t).then(function(t){e(t)})})},e.f=function(t){return new n.a(function(e){Object(s.b)("FriendsHelp.marketList",t).then(function(t){e(t)})})},e.e=function(t){return new n.a(function(e){Object(s.b)("FriendsHelp.helpOrderList",t).then(function(t){e(t)})})},e.b=function(t){return new n.a(function(e){Object(s.b)("FriendsHelp.changeHelp",t).then(function(t){e(t)})})},e.c=function(t){return new n.a(function(e){Object(s.b)("FriendsHelp.delHelp",t).then(function(t){e(t)})})},e.g=function(t){return new n.a(function(e){Object(s.b)("FriendsHelp.showMarket",t).then(function(t){e(t)})})},e.d=function(t){return new n.a(function(e){Object(s.b)("FriendsHelp.getCourseList",t).then(function(t){e(t)})})};var a=i("rVsN"),n=i.n(a),s=i("60kx")},NZz6:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("EIOx"),n={name:"FriendHelpAdd",data:function(){return{activityForm:{title:"",date:[],num:""},isDiscount:!0,discount:"",tableDataList:[],dialogFormVisible:!1,addInfo:{name:"",courseIndex:"",list:[]},selectCourseList:[],rules:{title:[{required:!0,message:"请输入活动名称"},{min:0,max:10,message:"长度在 0 到 10 个字符"}],date:[{type:"array",required:!0,message:"请选择日期"}],num:[{required:!0,message:"请输入人数"},{type:"number",message:"年龄必须为数字值",trigger:"change"}]}}},computed:{judgeCourseType:function(){return function(t){return 1==t?"视频":2==t?"直播":3==t?"音频":4==t?"图文":5==t?"面授":6==t?"活动":7==t?"训练营":void 0}},disabledCourse:function(){return function(t){if(this.tableDataList.length>0)return this.tableDataList.some(function(e,i){return e.courseid==t})}}},activated:function(){var t=this;this.$route.query.id?Object(a.g)({id:this.$route.query.id}).then(function(e){(e.result="success")&&(t.activityForm.title=e.title,t.activityForm.date=[],t.activityForm.date.push(t.formatTimestamp(1e3*e.starttime)),t.activityForm.date.push(t.formatTimestamp(1e3*e.endtime)),t.activityForm.num=+e.num,0==e.discount?(t.discount="",t.isDiscount=!0):(t.discount=e.discount,t.isDiscount=!1),t.tableDataList=e.json)}):(this.$refs.resetFrom.resetFields(),this.discount="",this.tableDataList=[])},methods:{monitor:function(){this.activityForm.num>0&&(this.activityForm.num<2?this.activityForm.num=2:this.activityForm.num>50&&(this.activityForm.num=50))},handleSelectionChange:function(t){this.selectCourseList=t},addCourse:function(){this.addInfo.name="",this.addInfo.courseIndex="",this.addInfo.list=[],this.dialogFormVisible=!0},getCourseData:function(){var t=this;Object(a.d)({id:this.$route.query.id}).then(function(e){t.addInfo.list=e})},confirmAddCourse:function(){var t=this.addInfo.courseIndex;this.tableDataList.push(this.addInfo.list[t]),this.dialogFormVisible=!1},deleteCourse:function(t){this.tableDataList.splice(t,1)},deleteSelectCourse:function(){var t=this;this.selectCourseList.length>0&&this.selectCourseList.forEach(function(e){var i=t.tableDataList.findIndex(function(t){return e.courseid==t.courseid});t.tableDataList.splice(i,1)})},saveTrainCamp:function(){var t=this;this.$refs.resetFrom.validate(function(e){if(e){if(0==t.tableDataList.length)return t.$msg("必须添加一种活动商品"),!1;var i={title:t.activityForm.title,starttime:new Date(t.activityForm.date[0]).getTime(),endtime:new Date(t.activityForm.date[1]).getTime(),num:t.activityForm.num,discount:t.isDiscount?"0":t.discount,json:[]};t.$route.query.id&&(i.marketid=t.$route.query.id),t.tableDataList.forEach(function(t){var e={courseid:t.courseid,course_type:t.course_type};i.json.push(e)}),Object(a.a)(i).then(function(e){(e.result="success")&&t.$router.go(-1)})}})},cancel:function(){this.$router.go(-1)},formatTimestamp:function(t){return(new Date).setTime(t)}}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ks-container",[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",{attrs:{to:{name:"FriendHelp"}}},[t._v("好友助力")]),t._v(" "),i("el-breadcrumb-item",[t._v("添加好友助力")])],1),t._v(" "),i("el-row",{staticClass:"activity"},[i("el-col",{staticClass:"activity-box",attrs:{span:12}},[i("h2",[t._v("活动信息")]),t._v(" "),i("el-form",{ref:"resetFrom",attrs:{model:t.activityForm,rules:t.rules,"label-width":"90px"}},[i("el-form-item",{attrs:{label:"活动名称",prop:"title"}},[i("el-input",{attrs:{placeholder:"活动名称不超过10个字"},model:{value:t.activityForm.title,callback:function(e){t.$set(t.activityForm,"title",e)},expression:"activityForm.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"活动时间",required:"",prop:"date"}},[i("el-date-picker",{staticStyle:{width:"100%","max-width":"600px"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.activityForm.date,callback:function(e){t.$set(t.activityForm,"date",e)},expression:"activityForm.date"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"助力人数",prop:"num"}},[i("el-input",{attrs:{placeholder:"可设置2-50人"},on:{blur:t.monitor},model:{value:t.activityForm.num,callback:function(e){t.$set(t.activityForm,"num",t._n(e))},expression:"activityForm.num"}})],1),t._v(" "),i("el-form-item",{staticClass:"activity-box__num-des"},[t._v("用户助力达到指定人数即可活动免费听课资格")]),t._v(" "),i("el-form-item",{attrs:{label:"优惠力度"}},[i("el-radio-group",{model:{value:t.isDiscount,callback:function(e){t.isDiscount=e},expression:"isDiscount"}},[i("el-radio",{attrs:{label:!0}},[t._v("免费")]),t._v(" "),i("el-radio",{attrs:{label:!1}},[t._v("折扣")])],1),t._v(" "),t.isDiscount?t._e():i("ks-input-number",{attrs:{min:.1,max:10,decimalPlaces:2,"max-width":"150px",placeholder:"设置范围0.1-10折"},model:{value:t.discount,callback:function(e){t.discount=e},expression:"discount"}})],1)],1)],1),t._v(" "),i("el-col",{staticClass:"activity-box",attrs:{span:12}},[i("h2",[t._v("活动商品")]),t._v(" "),i("el-button",{staticClass:"activity-box__add-btn",attrs:{icon:"el-icon-plus"},on:{click:t.addCourse}},[t._v("添加商品")]),t._v(" "),i("el-table",{ref:"multipleTable",staticClass:"activity-table",staticStyle:{width:"100%"},attrs:{data:t.tableDataList,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{"min-width":"500"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("img",{attrs:{src:e.row.defaultpic}}),t._v(" "),i("div",{staticClass:"activity-table__detail"},[i("div",{staticClass:"activity-table__detail-title"},[t._v(t._s(e.row.title))]),t._v(" "),i("div",{staticClass:"activity-table__detail-price"},[t._v("￥"+t._s(e.row.price))]),t._v(" "),i("div",{staticClass:"activity-table__detail-type"},[t._v("商品类型:"+t._s(t.judgeCourseType(e.row.course_type)))])])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{on:{click:function(i){return t.deleteCourse(e.$index)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("el-button",{staticClass:"activity-box__delete-btn",attrs:{plain:"",size:"mini"},on:{click:t.deleteSelectCourse}},[i("i",{staticClass:"iconfont icon-shanchu1"})])],1)],1),t._v(" "),i("div",{staticClass:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.saveTrainCamp}},[t._v("保存返回")]),t._v(" "),i("el-button",{attrs:{plain:""},on:{click:t.cancel}},[t._v("取消")])],1),t._v(" "),i("el-dialog",{staticClass:"add-dialog",attrs:{title:"添加商品",visible:t.dialogFormVisible,width:"30%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{model:t.addInfo}},[i("el-form-item",{attrs:{label:"【选择类型】"}},[i("el-select",{attrs:{placeholder:"请选择添加类型"},on:{change:t.getCourseData},model:{value:t.addInfo.name,callback:function(e){t.$set(t.addInfo,"name",e)},expression:"addInfo.name"}},[i("el-option",{attrs:{label:"课程",value:"2"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"【选择课程】"}},[i("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:t.addInfo.courseIndex,callback:function(e){t.$set(t.addInfo,"courseIndex",e)},expression:"addInfo.courseIndex"}},t._l(t.addInfo.list,function(e,a){return i("el-option",{key:a,attrs:{label:e.title,value:a,disabled:t.disabledCourse(e.courseid)}})}),1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.confirmAddCourse}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var o=i("C7Lr")(n,s,!1,function(t){i("zH3l")},"data-v-56eff304",null);e.default=o.exports},zH3l:function(t,e){}});