webpackJsonp([55],{d7oP:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("UTmX"),n={name:"GetVodList",data:function(){return{vodtrancode:"",loaded:!1,vod:{fileName:"",progress:0,visible:!1},space:"",traffic:"",current:{},keyword:"",page:1,pageCount:1,selectAll:!1,list:[],windowHeight:window.innerHeight,selectedList:[]}},methods:{handleSelectionChange:function(t){t.length===this.list.length?this.selectAll=!0:this.selectAll=!1,this.selectedList=t},getDataList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$showLoading(),Object(i.d)({p:e,maxperpage:9,keyword:this.keyword}).then(function(e){t.list=e.list,t.page=e.page.now_page,t.pageCount=e.page.total_pages,t.loaded=!0,t.updateVod(),t.$hideLoading()})},cancel:function(){"popup"===this.$route.query.from?top.closePopup(window.name):this.$emit("cancel")},updateVod:function(){var t=this,e=[];if(this.list.map(function(t){/^PROCESSING$/i.test(t.status)&&e.push(t.id)}),!e.length)return!1;Object(i.g)({vdoService:10,ids:e.join(",")}).then(function(e){if("success"===e.result){var s=/^NORMAL$/i;e.list.map(function(e){s.test(e.status)&&t.list.map(function(t){t.id==e.id&&(t.status=e.status,t.playtime=e.playtime,t.vdoImg=e.vdoImg,t.vdoSize=e.vdoSize)})}),setTimeout(function(){t.updateVod()},5e3)}})},sure:function(){if("popup"===this.$route.query.from){var t=top.popup.data(window.name);"function"==typeof t&&t(this.current.vdoName,this.current.vdoId),top.closePopup(window.name)}else this.$emit("sure",this.current)},handleCommand:function(t){var e=this;switch(t){case"tencent":top.KS_UploadVideoFile({type:"tencent",onUploaded:function(t){e.$msg("上传成功","success"),e.getDataList()}});break;case"polyv":return void this.$msg("正在整合中，即将开放")}},delVod:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{type:"warning"}).then(function(){e.$showLoading(),Object(i.b)({ids:t}).then(function(t){e.$msg(t.msg,t.result),"success"===t.result&&(e.$hideLoading(),e.getDataList())})})},deleteItem:function(){var t=[];this.selectedList.map(function(e){t.push(e.id)}),t.length?this.delVod(t.join()):this.$msg("请先选择要删除的视频")},open:function(t){location.href=t}},mounted:function(){var t=this;this.getDataList(),"list"===this.$route.query.action&&Object(i.e)().then(function(e){t.space=e.space,t.traffic=e.traffic,t.vodtrancode=e.vodtrancode}),window.addEventListener("resize",function(){t.windowHeight=window.innerHeight})}},a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",["list"===t.$route.query.action?s("ks-container",[s("ks-title",{attrs:{name:"媒资库",border:"none"}},[s("div",{staticClass:"ks-fr ks-fz14 ks-info-color"},[t._v("\n        剩余空间\n        "),s("span",{staticClass:"ks-color-primary"},[t._v(t._s(t.space))]),t._v("，剩余流量\n        "),s("span",{staticClass:"ks-color-primary"},[t._v(t._s(t.traffic))]),t._v("，剩余转码时间\n        "),s("span",{staticClass:"ks-color-primary"},[t._v(t._s(t.vodtrancode))]),t._v(" "),s("el-popover",{attrs:{placement:"top-start",title:"说明",width:"200",trigger:"hover"}},[s("p",{staticClass:"vod-popover"},[t._v("\n            空间详情：用于存储视频、图片等的空间。高级运营版空间无限时，建议及时升级。\n            "),s("br"),t._v("流量：用于点播产生的视频流量\n            "),s("br"),t._v("转码：用于视频上传后的转码费用\n          ")]),t._v(" "),s("i",{staticClass:"el-icon-info ks-color-warning ks-ml10",attrs:{slot:"reference"},slot:"reference"})]),t._v(" "),s("el-button",{staticClass:"ks-ml10",attrs:{size:"medium"},on:{click:function(e){return t.$router.push("/?url=/home.html/default/Shop/coludmanage/3")}}},[t._v("获空间扶持")]),t._v(" "),s("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.$router.push("/?url=/home.html/default/Shop/coludmanage/4")}}},[t._v("购买流量")]),t._v(" "),s("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.$router.push("/?url=/home.html/default/Shop/coludmanage/7")}}},[t._v("购买转码时长")])],1)]),t._v(" "),s("div",{staticClass:"clearfix"},[s("el-button",{staticClass:"ks-fr",attrs:{type:"primary",icon:"el-icon-upload"},on:{click:function(e){return t.handleCommand("tencent")}}},[t._v("本地上传")]),t._v(" "),s("el-input",{staticClass:"ks-max-w-fit",attrs:{placeholder:"请输入视频标题搜索"},on:{change:function(e){return t.getDataList()}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[s("i",{staticClass:"el-icon-search el-input__icon ks-cursor-pointer",attrs:{slot:"suffix"},on:{click:function(e){return t.getDataList()}},slot:"suffix"})])],1),t._v(" "),t.list.length?s("div",[s("el-table",{ref:"listTable",staticClass:"ks-mt20",attrs:{data:t.list},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{label:"视频封面",width:"160"},scopedSlots:t._u([{key:"default",fn:function(t){return s("ks-create-bg",{attrs:{width:"120px",ratio:9/16,src:t.row.vdoImg}})}}],null,!1,2641323559)}),t._v(" "),s("el-table-column",{attrs:{prop:"vdoName",label:"视频标题"}}),t._v(" "),s("el-table-column",{attrs:{width:"120",prop:"playtime",label:"时长"}}),t._v(" "),s("el-table-column",{attrs:{prop:"vdoSize",label:"大小",width:"100"}}),t._v(" "),s("el-table-column",{attrs:{prop:"addDate",label:"添加时间",width:"200"}}),t._v(" "),s("el-table-column",{attrs:{label:"状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s("normal"===e.row.status?"正常":"视频转码中"))]}}],null,!1,3627897870)}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return s("el-tooltip",{attrs:{effect:"dark",content:"删除",placement:"top"}},[s("i",{staticClass:"iconfont icon-shanchu1 ks-cursor-pointer",on:{click:function(s){return t.delVod(e.row.id)}}})])}}],null,!1,4049307984)})],1),t._v(" "),s("div",{staticClass:"vod-list-footer clearfix",staticStyle:{padding:"30px 14px 0 14px"}},[s("div",{staticClass:"ks-fl"},[s("el-checkbox",{on:{change:function(e){return t.$refs.listTable.toggleAllSelection()}},model:{value:t.selectAll,callback:function(e){t.selectAll=e},expression:"selectAll"}},[t._v("全选")]),t._v(" "),s("el-button",{on:{click:t.deleteItem}},[t._v("删除数据")])],1),t._v(" "),s("div",{staticClass:"ks-fr"},[s("el-pagination",{attrs:{"current-page":t.page,"page-count":t.pageCount,layout:"prev, pager, next",background:""},on:{"current-change":t.getDataList,"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1)])],1):t.loaded&&!t.list.length?s("div",{staticClass:"ks-empty"},[t._v("没有找到任何视频~")]):t._e()],1):s("div",{staticClass:"vod-list-container"},[s("div",{staticClass:"vod-list-head clearfix"},[s("el-button",{staticClass:"ks-fr",attrs:{type:"primary",icon:"el-icon-upload"},on:{click:function(e){return t.handleCommand("tencent")}}},[t._v("本地上传")]),t._v(" "),s("el-input",{staticClass:"ks-max-w-fit",attrs:{placeholder:"请输入视频标题搜索"},on:{change:function(e){return t.getDataList()}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[s("i",{staticClass:"el-icon-search el-input__icon ks-cursor-pointer",attrs:{slot:"suffix"},on:{click:function(e){return t.getDataList()}},slot:"suffix"})])],1),t._v(" "),t.list.length?s("div",[s("div",{staticClass:"vod-list",style:{height:t.windowHeight-185+"px"}},[s("el-row",{attrs:{gutter:25}},t._l(t.list,function(e){return s("el-col",{key:e.id,attrs:{span:8}},[s("div",{staticClass:"vod-list__item",on:{click:function(s){t.current=e.id===t.current.id?{}:e}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.id==t.current.id,expression:"item.id == current.id"}],staticClass:"ks-select-mask"},[s("i",{staticClass:"el-icon-check"})]),t._v(" "),s("ks-create-bg",{attrs:{ratio:9/16,src:e.vdoImg}},["normal"!==e.status?s("div",{staticClass:"vod-list__tip"},[t._v("视频转码中")]):s("div",{staticClass:"vod-list__time"},[t._v(t._s(e.playtime))])]),t._v(" "),s("div",{staticClass:"ks-fz14 vod-list__vdo_name"},[s("div",{staticClass:"ks-text-nowrap"},[s("el-tag",{attrs:{size:"mini",effect:"plain"}},[t._v("腾讯云")]),t._v("   "+t._s(e.vdoName))],1)])],1)])}),1)],1),t._v(" "),s("div",{staticClass:"vod-list-footer clearfix"},[s("div",{staticClass:"ks-fl"},[s("el-button",{attrs:{type:"primary",disabled:!t.current.id},on:{click:t.sure}},[t._v("确定")]),t._v(" "),s("el-button",{on:{click:t.cancel}},[t._v("取消")])],1),t._v(" "),s("div",{staticClass:"ks-fr"},[s("el-pagination",{attrs:{"current-page":t.page,"page-count":t.pageCount,layout:"prev, pager, next",background:""},on:{"current-change":t.getDataList,"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}})],1)])]):t.loaded&&!t.list.length?s("div",{staticClass:"ks-empty"},[t._v("没有找到任何视频~")]):t._e()])],1)},staticRenderFns:[]};var o=s("C7Lr")(n,a,!1,function(t){s("oc7f")},"data-v-073406de",null);e.default=o.exports},oc7f:function(t,e){}});